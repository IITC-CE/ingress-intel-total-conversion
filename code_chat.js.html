

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: code/chat.js | IITC-CE</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="; height: 0">
        
            <a href="https://github.com/IITC-CE/ingress-intel-total-conversion" rel="noopener noreferrer" target="_blank">
                <img src="img/toast-ui.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">IITC-CE</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-_deprecated.html">_deprecated</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:_deprecated_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-_deprecated.html#~findPortalLatLng">findPortalLatLng</a></li><li><a href="module-_deprecated.html#~findPortalLatLng">findPortalLatLng</a></li><li><a href="module-_deprecated.html#~getPortalApGain">getPortalApGain</a></li><li><a href="module-_deprecated.html#~getPortalApGain">getPortalApGain</a></li><li><a href="module-_deprecated.html#~portalApGainMaths">portalApGainMaths</a></li><li><a href="module-_deprecated.html#~portalApGainMaths">portalApGainMaths</a></li><li><a href="module-_deprecated.html#~potentialPortalLevel">potentialPortalLevel</a></li><li><a href="module-_deprecated.html#~potentialPortalLevel">potentialPortalLevel</a></li></ul></div></li><li><a href="module-app.html">app</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:app_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-app.html#.isApp">isApp</a></li><li><a href="module-app.html#.isApp">isApp</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-app.html#~debounce">debounce</a></li><li><a href="module-app.html#~debounce">debounce</a></li><li><a href="module-app.html#~useAppPanes">useAppPanes</a></li><li><a href="module-app.html#~useAppPanes">useAppPanes</a></li></ul></div></li><li><a href="module-boot.html">boot</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:boot_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-boot.html#~boot">boot</a></li><li><a href="module-boot.html#~boot">boot</a></li><li><a href="module-boot.html#~checkingIntelURL">checkingIntelURL</a></li><li><a href="module-boot.html#~checkingIntelURL">checkingIntelURL</a></li><li><a href="module-boot.html#~prepPluginsToLoad">prepPluginsToLoad</a></li><li><a href="module-boot.html#~prepPluginsToLoad">prepPluginsToLoad</a></li><li><a href="module-boot.html#~registerMarkerForOMS">registerMarkerForOMS</a></li><li><a href="module-boot.html#~registerMarkerForOMS">registerMarkerForOMS</a></li><li><a href="module-boot.html#~setupIngressMarkers">setupIngressMarkers</a></li><li><a href="module-boot.html#~setupIngressMarkers">setupIngressMarkers</a></li><li><a href="module-boot.html#~setupOMS">setupOMS</a></li><li><a href="module-boot.html#~setupOMS">setupOMS</a></li><li><a href="module-boot.html#~setupTooltips">setupTooltips</a></li><li><a href="module-boot.html#~setupTooltips">setupTooltips</a></li></ul></div></li><li><a href="module-dialog.html">dialog</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:dialog_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-dialog.html#.window.DIALOG_ID">window.DIALOG_ID</a></li><li><a href="module-dialog.html#.window.DIALOG_ID">window.DIALOG_ID</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-dialog.html#~alert">alert</a></li><li><a href="module-dialog.html#~alert">alert</a></li><li><a href="module-dialog.html#~dialog">dialog</a></li><li><a href="module-dialog.html#~dialog">dialog</a></li></ul></div></li><li><a href="module-dialog_about.html">dialog_about</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:dialog_about_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-dialog_about.html#~convertPluginInfo">convertPluginInfo</a></li><li><a href="module-dialog_about.html#~convertPluginInfo">convertPluginInfo</a></li><li><a href="module-dialog_about.html#~createChangelog">createChangelog</a></li><li><a href="module-dialog_about.html#~createChangelog">createChangelog</a></li><li><a href="module-dialog_about.html#~createDialogContent">createDialogContent</a></li><li><a href="module-dialog_about.html#~createDialogContent">createDialogContent</a></li><li><a href="module-dialog_about.html#~formatVerInfo">formatVerInfo</a></li><li><a href="module-dialog_about.html#~formatVerInfo">formatVerInfo</a></li><li><a href="module-dialog_about.html#~getIITCVersion">getIITCVersion</a></li><li><a href="module-dialog_about.html#~getIITCVersion">getIITCVersion</a></li><li><a href="module-dialog_about.html#~getIITCVersionAddition">getIITCVersionAddition</a></li><li><a href="module-dialog_about.html#~getIITCVersionAddition">getIITCVersionAddition</a></li><li><a href="module-dialog_about.html#~getPlugins">getPlugins</a></li><li><a href="module-dialog_about.html#~getPlugins">getPlugins</a></li><li><a href="module-dialog_about.html#~isShortOnLocalStorage">isShortOnLocalStorage</a></li><li><a href="module-dialog_about.html#~isShortOnLocalStorage">isShortOnLocalStorage</a></li><li><a href="module-dialog_about.html#~isStandardPlugin">isStandardPlugin</a></li><li><a href="module-dialog_about.html#~isStandardPlugin">isStandardPlugin</a></li><li><a href="module-dialog_about.html#~pluginInfoToString">pluginInfoToString</a></li><li><a href="module-dialog_about.html#~pluginInfoToString">pluginInfoToString</a></li></ul></div></li><li><a href="module-entity_decode.html">entity_decode</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entity_decode_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entity_decode.html#~corePortalData">corePortalData</a></li><li><a href="module-entity_decode.html#~corePortalData">corePortalData</a></li><li><a href="module-entity_decode.html#~detailsPortalData">detailsPortalData</a></li><li><a href="module-entity_decode.html#~detailsPortalData">detailsPortalData</a></li><li><a href="module-entity_decode.html#~extendedPortalData">extendedPortalData</a></li><li><a href="module-entity_decode.html#~extendedPortalData">extendedPortalData</a></li><li><a href="module-entity_decode.html#~parseArtifactBrief">parseArtifactBrief</a></li><li><a href="module-entity_decode.html#~parseArtifactBrief">parseArtifactBrief</a></li><li><a href="module-entity_decode.html#~parseArtifactDetail">parseArtifactDetail</a></li><li><a href="module-entity_decode.html#~parseArtifactDetail">parseArtifactDetail</a></li><li><a href="module-entity_decode.html#~parseHistoryDetail">parseHistoryDetail</a></li><li><a href="module-entity_decode.html#~parseHistoryDetail">parseHistoryDetail</a></li><li><a href="module-entity_decode.html#~parseMod">parseMod</a></li><li><a href="module-entity_decode.html#~parseMod">parseMod</a></li><li><a href="module-entity_decode.html#~parseResonator">parseResonator</a></li><li><a href="module-entity_decode.html#~parseResonator">parseResonator</a></li><li><a href="module-entity_decode.html#~summaryPortalData">summaryPortalData</a></li><li><a href="module-entity_decode.html#~summaryPortalData">summaryPortalData</a></li></ul></div></li><li><a href="module-entity_info.html">entity_info</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:entity_info_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-entity_info.html#~getTeam">getTeam</a></li><li><a href="module-entity_info.html#~getTeam">getTeam</a></li><li><a href="module-entity_info.html#~teamStringToId">teamStringToId</a></li><li><a href="module-entity_info.html#~teamStringToId">teamStringToId</a></li></ul></div></li><li><a href="module-extract_niantic_parameters.html">extract_niantic_parameters</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:extract_niantic_parameters_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-extract_niantic_parameters.html#~extractFromStock">extractFromStock</a></li><li><a href="module-extract_niantic_parameters.html#~extractFromStock">extractFromStock</a></li></ul></div></li><li><a href="module-game_status.html">game_status</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:game_status_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-game_status.html#~updateGameScore">updateGameScore</a></li><li><a href="module-game_status.html#~updateGameScore">updateGameScore</a></li></ul></div></li><li><a href="module-hooks.html">hooks</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:hooks_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-hooks.html#~addHook">addHook</a></li><li><a href="module-hooks.html#~addHook">addHook</a></li><li><a href="module-hooks.html#~removeHook">removeHook</a></li><li><a href="module-hooks.html#~removeHook">removeHook</a></li><li><a href="module-hooks.html#~runHooks">runHooks</a></li><li><a href="module-hooks.html#~runHooks">runHooks</a></li></ul></div></li><li><a href="module-idle.html">idle</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:idle_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-idle.html#~idleTime">idleTime</a></li><li><a href="module-idle.html#~idleTime">idleTime</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-idle.html#~addResumeFunction">addResumeFunction</a></li><li><a href="module-idle.html#~addResumeFunction">addResumeFunction</a></li><li><a href="module-idle.html#~idleReset">idleReset</a></li><li><a href="module-idle.html#~idleReset">idleReset</a></li><li><a href="module-idle.html#~idleSet">idleSet</a></li><li><a href="module-idle.html#~idleSet">idleSet</a></li><li><a href="module-idle.html#~isIdle">isIdle</a></li><li><a href="module-idle.html#~isIdle">isIdle</a></li><li><a href="module-idle.html#~setupIdle">setupIdle</a></li><li><a href="module-idle.html#~setupIdle">setupIdle</a></li></ul></div></li><li><a href="module-map.html">map</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:map_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-map.html#~createDefaultBaseMapLayers">createDefaultBaseMapLayers</a></li><li><a href="module-map.html#~createDefaultBaseMapLayers">createDefaultBaseMapLayers</a></li><li><a href="module-map.html#~createDefaultOverlays">createDefaultOverlays</a></li><li><a href="module-map.html#~createDefaultOverlays">createDefaultOverlays</a></li><li><a href="module-map.html#~getPosition">getPosition</a></li><li><a href="module-map.html#~getPosition">getPosition</a></li><li><a href="module-map.html#~normLL">normLL</a></li><li><a href="module-map.html#~normLL">normLL</a></li><li><a href="module-map.html#~setupMap">setupMap</a></li><li><a href="module-map.html#~setupMap">setupMap</a></li></ul></div></li><li><a href="module-map_data_calc_tools.html">map_data_calc_tools</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:map_data_calc_tools_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-map_data_calc_tools.html#~getDataZoomForMapZoom">getDataZoomForMapZoom</a></li><li><a href="module-map_data_calc_tools.html#~getDataZoomForMapZoom">getDataZoomForMapZoom</a></li><li><a href="module-map_data_calc_tools.html#~getMapZoomTileParameters">getMapZoomTileParameters</a></li><li><a href="module-map_data_calc_tools.html#~getMapZoomTileParameters">getMapZoomTileParameters</a></li><li><a href="module-map_data_calc_tools.html#~setupDataTileParams">setupDataTileParams</a></li><li><a href="module-map_data_calc_tools.html#~setupDataTileParams">setupDataTileParams</a></li></ul></div></li><li><a href="module-panes.html">panes</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:panes_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-panes.html#~currentPane">currentPane</a></li><li><a href="module-panes.html#~currentPane">currentPane</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-panes.html#~hideall">hideall</a></li><li><a href="module-panes.html#~hideall">hideall</a></li><li><a href="module-panes.html#~show">show</a></li><li><a href="module-panes.html#~show">show</a></li></ul></div></li><li><a href="module-player_names.html">player_names</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:player_names_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-player_names.html#~isSystemPlayer">isSystemPlayer</a></li><li><a href="module-player_names.html#~isSystemPlayer">isSystemPlayer</a></li></ul></div></li><li><a href="module-portal_data.html">portal_data</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_data_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_data.html#~findPortalGuidByPositionE6">findPortalGuidByPositionE6</a></li><li><a href="module-portal_data.html#~findPortalGuidByPositionE6">findPortalGuidByPositionE6</a></li><li><a href="module-portal_data.html#~getPortalFields">getPortalFields</a></li><li><a href="module-portal_data.html#~getPortalFields">getPortalFields</a></li><li><a href="module-portal_data.html#~getPortalFieldsCount">getPortalFieldsCount</a></li><li><a href="module-portal_data.html#~getPortalFieldsCount">getPortalFieldsCount</a></li><li><a href="module-portal_data.html#~getPortalLinks">getPortalLinks</a></li><li><a href="module-portal_data.html#~getPortalLinks">getPortalLinks</a></li><li><a href="module-portal_data.html#~getPortalLinksCount">getPortalLinksCount</a></li><li><a href="module-portal_data.html#~getPortalLinksCount">getPortalLinksCount</a></li><li><a href="module-portal_data.html#~pushPortalGuidPositionCache">pushPortalGuidPositionCache</a></li><li><a href="module-portal_data.html#~pushPortalGuidPositionCache">pushPortalGuidPositionCache</a></li></ul></div></li><li><a href="module-portal_detail_display.html">portal_detail_display</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_detail_display_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_detail_display.html#~getPortalMiscDetails">getPortalMiscDetails</a></li><li><a href="module-portal_detail_display.html#~getPortalMiscDetails">getPortalMiscDetails</a></li><li><a href="module-portal_detail_display.html#~renderPortalDetails">renderPortalDetails</a></li><li><a href="module-portal_detail_display.html#~renderPortalDetails">renderPortalDetails</a></li><li><a href="module-portal_detail_display.html#~renderPortalUrl">renderPortalUrl</a></li><li><a href="module-portal_detail_display.html#~renderPortalUrl">renderPortalUrl</a></li><li><a href="module-portal_detail_display.html#~resetScrollOnNewPortal">resetScrollOnNewPortal</a></li><li><a href="module-portal_detail_display.html#~resetScrollOnNewPortal">resetScrollOnNewPortal</a></li><li><a href="module-portal_detail_display.html#~selectPortal">selectPortal</a></li><li><a href="module-portal_detail_display.html#~selectPortal">selectPortal</a></li><li><a href="module-portal_detail_display.html#~setPortalIndicators">setPortalIndicators</a></li><li><a href="module-portal_detail_display.html#~setPortalIndicators">setPortalIndicators</a></li></ul></div></li><li><a href="module-portal_detail_display_tools.html">portal_detail_display_tools</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_detail_display_tools_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_detail_display_tools.html#~getAttackApGainText">getAttackApGainText</a></li><li><a href="module-portal_detail_display_tools.html#~getAttackApGainText">getAttackApGainText</a></li><li><a href="module-portal_detail_display_tools.html#~getEnergyText">getEnergyText</a></li><li><a href="module-portal_detail_display_tools.html#~getEnergyText">getEnergyText</a></li><li><a href="module-portal_detail_display_tools.html#~getHackDetailsText">getHackDetailsText</a></li><li><a href="module-portal_detail_display_tools.html#~getHackDetailsText">getHackDetailsText</a></li><li><a href="module-portal_detail_display_tools.html#~getMitigationText">getMitigationText</a></li><li><a href="module-portal_detail_display_tools.html#~getMitigationText">getMitigationText</a></li><li><a href="module-portal_detail_display_tools.html#~getModDetails">getModDetails</a></li><li><a href="module-portal_detail_display_tools.html#~getModDetails">getModDetails</a></li><li><a href="module-portal_detail_display_tools.html#~getPortalHistoryDetails">getPortalHistoryDetails</a></li><li><a href="module-portal_detail_display_tools.html#~getPortalHistoryDetails">getPortalHistoryDetails</a></li><li><a href="module-portal_detail_display_tools.html#~getRangeText">getRangeText</a></li><li><a href="module-portal_detail_display_tools.html#~getRangeText">getRangeText</a></li><li><a href="module-portal_detail_display_tools.html#~getResonatorDetails">getResonatorDetails</a></li><li><a href="module-portal_detail_display_tools.html#~getResonatorDetails">getResonatorDetails</a></li><li><a href="module-portal_detail_display_tools.html#~renderResonatorDetails">renderResonatorDetails</a></li><li><a href="module-portal_detail_display_tools.html#~renderResonatorDetails">renderResonatorDetails</a></li></ul></div></li><li><a href="module-portal_highlighter.html">portal_highlighter</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_highlighter_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_highlighter.html#~addPortalHighlighter">addPortalHighlighter</a></li><li><a href="module-portal_highlighter.html#~addPortalHighlighter">addPortalHighlighter</a></li><li><a href="module-portal_highlighter.html#~changePortalHighlights">changePortalHighlights</a></li><li><a href="module-portal_highlighter.html#~changePortalHighlights">changePortalHighlights</a></li><li><a href="module-portal_highlighter.html#~highlightPortal">highlightPortal</a></li><li><a href="module-portal_highlighter.html#~highlightPortal">highlightPortal</a></li><li><a href="module-portal_highlighter.html#~resetHighlightedPortals">resetHighlightedPortals</a></li><li><a href="module-portal_highlighter.html#~resetHighlightedPortals">resetHighlightedPortals</a></li><li><a href="module-portal_highlighter.html#~updatePortalHighlighterControl">updatePortalHighlighterControl</a></li><li><a href="module-portal_highlighter.html#~updatePortalHighlighterControl">updatePortalHighlighterControl</a></li></ul></div></li><li><a href="module-portal_info.html">portal_info</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_info_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_info.html#~fixPortalImageUrl">fixPortalImageUrl</a></li><li><a href="module-portal_info.html#~fixPortalImageUrl">fixPortalImageUrl</a></li><li><a href="module-portal_info.html#~getAttackApGain">getAttackApGain</a></li><li><a href="module-portal_info.html#~getAttackApGain">getAttackApGain</a></li><li><a href="module-portal_info.html#~getCurrentPortalEnergy">getCurrentPortalEnergy</a></li><li><a href="module-portal_info.html#~getCurrentPortalEnergy">getCurrentPortalEnergy</a></li><li><a href="module-portal_info.html#~getLinkAmpRangeBoost">getLinkAmpRangeBoost</a></li><li><a href="module-portal_info.html#~getLinkAmpRangeBoost">getLinkAmpRangeBoost</a></li><li><a href="module-portal_info.html#~getMaxOutgoingLinks">getMaxOutgoingLinks</a></li><li><a href="module-portal_info.html#~getMaxOutgoingLinks">getMaxOutgoingLinks</a></li><li><a href="module-portal_info.html#~getPortalAttackValues">getPortalAttackValues</a></li><li><a href="module-portal_info.html#~getPortalAttackValues">getPortalAttackValues</a></li><li><a href="module-portal_info.html#~getPortalHackDetails">getPortalHackDetails</a></li><li><a href="module-portal_info.html#~getPortalHackDetails">getPortalHackDetails</a></li><li><a href="module-portal_info.html#~getPortalLevel">getPortalLevel</a></li><li><a href="module-portal_info.html#~getPortalLevel">getPortalLevel</a></li><li><a href="module-portal_info.html#~getPortalLinkDefenseBoost">getPortalLinkDefenseBoost</a></li><li><a href="module-portal_info.html#~getPortalLinkDefenseBoost">getPortalLinkDefenseBoost</a></li><li><a href="module-portal_info.html#~getPortalLinksMitigation">getPortalLinksMitigation</a></li><li><a href="module-portal_info.html#~getPortalLinksMitigation">getPortalLinksMitigation</a></li><li><a href="module-portal_info.html#~getPortalMitigationDetails">getPortalMitigationDetails</a></li><li><a href="module-portal_info.html#~getPortalMitigationDetails">getPortalMitigationDetails</a></li><li><a href="module-portal_info.html#~getPortalModsByType">getPortalModsByType</a></li><li><a href="module-portal_info.html#~getPortalModsByType">getPortalModsByType</a></li><li><a href="module-portal_info.html#~getPortalRange">getPortalRange</a></li><li><a href="module-portal_info.html#~getPortalRange">getPortalRange</a></li><li><a href="module-portal_info.html#~getPortalShieldMitigation">getPortalShieldMitigation</a></li><li><a href="module-portal_info.html#~getPortalShieldMitigation">getPortalShieldMitigation</a></li><li><a href="module-portal_info.html#~getPortalSummaryData">getPortalSummaryData</a></li><li><a href="module-portal_info.html#~getPortalSummaryData">getPortalSummaryData</a></li><li><a href="module-portal_info.html#~getTotalPortalEnergy">getTotalPortalEnergy</a></li><li><a href="module-portal_info.html#~getTotalPortalEnergy">getTotalPortalEnergy</a></li></ul></div></li><li><a href="module-portal_marker.html">portal_marker</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:portal_marker_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-portal_marker.html#~createMarker">createMarker</a></li><li><a href="module-portal_marker.html#~createMarker">createMarker</a></li><li><a href="module-portal_marker.html#~getMarkerStyleOptions">getMarkerStyleOptions</a></li><li><a href="module-portal_marker.html#~getMarkerStyleOptions">getMarkerStyleOptions</a></li><li><a href="module-portal_marker.html#~portalMarkerScale">portalMarkerScale</a></li><li><a href="module-portal_marker.html#~portalMarkerScale">portalMarkerScale</a></li><li><a href="module-portal_marker.html#~setMarkerStyle">setMarkerStyle</a></li><li><a href="module-portal_marker.html#~setMarkerStyle">setMarkerStyle</a></li></ul></div></li><li><a href="module-redeeming.html">redeeming</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:redeeming_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-redeeming.html#~REDEEM_SHORT_NAMES">REDEEM_SHORT_NAMES</a></li><li><a href="module-redeeming.html#~REDEEM_SHORT_NAMES">REDEEM_SHORT_NAMES</a></li><li><a href="module-redeeming.html#~REDEEM_STATUSES">REDEEM_STATUSES</a></li><li><a href="module-redeeming.html#~REDEEM_STATUSES">REDEEM_STATUSES</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-redeeming.html#~formatPasscodeLong">formatPasscodeLong</a></li><li><a href="module-redeeming.html#~formatPasscodeLong">formatPasscodeLong</a></li><li><a href="module-redeeming.html#~formatPasscodeShort">formatPasscodeShort</a></li><li><a href="module-redeeming.html#~formatPasscodeShort">formatPasscodeShort</a></li><li><a href="module-redeeming.html#~handleRedeemResponse">handleRedeemResponse</a></li><li><a href="module-redeeming.html#~handleRedeemResponse">handleRedeemResponse</a></li><li><a href="module-redeeming.html#~setupRedeem">setupRedeem</a></li><li><a href="module-redeeming.html#~setupRedeem">setupRedeem</a></li></ul></div></li><li><a href="module-region_scoreboard.html">region_scoreboard</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:region_scoreboard_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-region_scoreboard.html#~HistoryChart">HistoryChart</a></li><li><a href="module-region_scoreboard.html#~HistoryChart">HistoryChart</a></li><li><a href="module-region_scoreboard.html#~RegionScoreboardSetup">RegionScoreboardSetup</a></li><li><a href="module-region_scoreboard.html#~RegionScoreboardSetup">RegionScoreboardSetup</a></li></ul></div></li><li><a href="module-request_handling.html">request_handling</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:request_handling_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-request_handling.html#~startRefreshTimeout">startRefreshTimeout</a></li><li><a href="module-request_handling.html#~startRefreshTimeout">startRefreshTimeout</a></li></ul></div></li><li><a href="module-send_request.html">send_request</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:send_request_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-send_request.html#~outOfDateUserPrompt">outOfDateUserPrompt</a></li><li><a href="module-send_request.html#~outOfDateUserPrompt">outOfDateUserPrompt</a></li><li><a href="module-send_request.html#~postAjax">postAjax</a></li><li><a href="module-send_request.html#~postAjax">postAjax</a></li></ul></div></li><li><a href="module-sidebar.html">sidebar</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:sidebar_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-sidebar.html#~setPermaLink">setPermaLink</a></li><li><a href="module-sidebar.html#~setPermaLink">setPermaLink</a></li><li><a href="module-sidebar.html#~setupAddons">setupAddons</a></li><li><a href="module-sidebar.html#~setupAddons">setupAddons</a></li><li><a href="module-sidebar.html#~setupIcons">setupIcons</a></li><li><a href="module-sidebar.html#~setupIcons">setupIcons</a></li><li><a href="module-sidebar.html#~setupLargeImagePreview">setupLargeImagePreview</a></li><li><a href="module-sidebar.html#~setupLargeImagePreview">setupLargeImagePreview</a></li><li><a href="module-sidebar.html#~setupPlayerStat">setupPlayerStat</a></li><li><a href="module-sidebar.html#~setupPlayerStat">setupPlayerStat</a></li><li><a href="module-sidebar.html#~setupSidebar">setupSidebar</a></li><li><a href="module-sidebar.html#~setupSidebar">setupSidebar</a></li><li><a href="module-sidebar.html#~setupSidebarToggle">setupSidebarToggle</a></li><li><a href="module-sidebar.html#~setupSidebarToggle">setupSidebarToggle</a></li><li><a href="module-sidebar.html#~setupStyles">setupStyles</a></li><li><a href="module-sidebar.html#~setupStyles">setupStyles</a></li></ul></div></li><li><a href="module-smartphone.html">smartphone</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:smartphone_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-smartphone.html#~isSmartphone">isSmartphone</a></li><li><a href="module-smartphone.html#~isSmartphone">isSmartphone</a></li><li><a href="module-smartphone.html#~runOnSmartphonesAfterBoot">runOnSmartphonesAfterBoot</a></li><li><a href="module-smartphone.html#~runOnSmartphonesAfterBoot">runOnSmartphonesAfterBoot</a></li><li><a href="module-smartphone.html#~runOnSmartphonesBeforeBoot">runOnSmartphonesBeforeBoot</a></li><li><a href="module-smartphone.html#~runOnSmartphonesBeforeBoot">runOnSmartphonesBeforeBoot</a></li><li><a href="module-smartphone.html#~smartphone">smartphone</a></li><li><a href="module-smartphone.html#~smartphone">smartphone</a></li><li><a href="module-smartphone.html#~smartphoneInfo">smartphoneInfo</a></li><li><a href="module-smartphone.html#~smartphoneInfo">smartphoneInfo</a></li></ul></div></li><li><a href="module-status_bar.html">status_bar</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:status_bar_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-status_bar.html#~renderUpdateStatus">renderUpdateStatus</a></li><li><a href="module-status_bar.html#~renderUpdateStatus">renderUpdateStatus</a></li></ul></div></li><li><a href="module-utils_file.html">utils_file</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:utils_file_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-utils_file.html#~saveAs">saveAs</a></li><li><a href="module-utils_file.html#~saveAs">saveAs</a></li><li><a href="module-utils_file.html#~saveFile">saveFile</a></li><li><a href="module-utils_file.html#~saveFile">saveFile</a></li></ul></div></li><li><a href="module-utils_misc.html">utils_misc</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:utils_misc_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-utils_misc.html#~clamp">clamp</a></li><li><a href="module-utils_misc.html#~clamp">clamp</a></li><li><a href="module-utils_misc.html#~clampLatLng">clampLatLng</a></li><li><a href="module-utils_misc.html#~clampLatLng">clampLatLng</a></li><li><a href="module-utils_misc.html#~clampLatLngBounds">clampLatLngBounds</a></li><li><a href="module-utils_misc.html#~clampLatLngBounds">clampLatLngBounds</a></li><li><a href="module-utils_misc.html#~convertTextToTableMagic">convertTextToTableMagic</a></li><li><a href="module-utils_misc.html#~convertTextToTableMagic">convertTextToTableMagic</a></li><li><a href="module-utils_misc.html#~digits">digits</a></li><li><a href="module-utils_misc.html#~digits">digits</a></li><li><a href="module-utils_misc.html#~eraseCookie">eraseCookie</a></li><li><a href="module-utils_misc.html#~eraseCookie">eraseCookie</a></li><li><a href="module-utils_misc.html#~escapeHtmlSpecialChars">escapeHtmlSpecialChars</a></li><li><a href="module-utils_misc.html#~escapeHtmlSpecialChars">escapeHtmlSpecialChars</a></li><li><a href="module-utils_misc.html#~escapeJavascriptString">escapeJavascriptString</a></li><li><a href="module-utils_misc.html#~escapeJavascriptString">escapeJavascriptString</a></li><li><a href="module-utils_misc.html#~formatDistance">formatDistance</a></li><li><a href="module-utils_misc.html#~formatDistance">formatDistance</a></li><li><a href="module-utils_misc.html#~formatInterval">formatInterval</a></li><li><a href="module-utils_misc.html#~formatInterval">formatInterval</a></li><li><a href="module-utils_misc.html#~getURLParam">getURLParam</a></li><li><a href="module-utils_misc.html#~getURLParam">getURLParam</a></li><li><a href="module-utils_misc.html#~isTouchDevice">isTouchDevice</a></li><li><a href="module-utils_misc.html#~isTouchDevice">isTouchDevice</a></li><li><a href="module-utils_misc.html#~makePrimeLink">makePrimeLink</a></li><li><a href="module-utils_misc.html#~makePrimeLink">makePrimeLink</a></li><li><a href="module-utils_misc.html#~prettyEnergy">prettyEnergy</a></li><li><a href="module-utils_misc.html#~prettyEnergy">prettyEnergy</a></li><li><a href="module-utils_misc.html#~rangeLinkClick">rangeLinkClick</a></li><li><a href="module-utils_misc.html#~rangeLinkClick">rangeLinkClick</a></li><li><a href="module-utils_misc.html#~readCookie">readCookie</a></li><li><a href="module-utils_misc.html#~readCookie">readCookie</a></li><li><a href="module-utils_misc.html#~scrollBottom">scrollBottom</a></li><li><a href="module-utils_misc.html#~scrollBottom">scrollBottom</a></li><li><a href="module-utils_misc.html#~selectPortalByLatLng">selectPortalByLatLng</a></li><li><a href="module-utils_misc.html#~selectPortalByLatLng">selectPortalByLatLng</a></li><li><a href="module-utils_misc.html#~showPortalPosLinks">showPortalPosLinks</a></li><li><a href="module-utils_misc.html#~showPortalPosLinks">showPortalPosLinks</a></li><li><a href="module-utils_misc.html#~uniqueArray">uniqueArray</a></li><li><a href="module-utils_misc.html#~uniqueArray">uniqueArray</a></li><li><a href="module-utils_misc.html#~unixTimeToDateTimeString">unixTimeToDateTimeString</a></li><li><a href="module-utils_misc.html#~unixTimeToDateTimeString">unixTimeToDateTimeString</a></li><li><a href="module-utils_misc.html#~unixTimeToHHmm">unixTimeToHHmm</a></li><li><a href="module-utils_misc.html#~unixTimeToHHmm">unixTimeToHHmm</a></li><li><a href="module-utils_misc.html#~unixTimeToString">unixTimeToString</a></li><li><a href="module-utils_misc.html#~unixTimeToString">unixTimeToString</a></li><li><a href="module-utils_misc.html#~writeCookie">writeCookie</a></li><li><a href="module-utils_misc.html#~writeCookie">writeCookie</a></li><li><a href="module-utils_misc.html#~zeroPad">zeroPad</a></li><li><a href="module-utils_misc.html#~zeroPad">zeroPad</a></li><li><a href="module-utils_misc.html#~zoomToAndShowPortal">zoomToAndShowPortal</a></li><li><a href="module-utils_misc.html#~zoomToAndShowPortal">zoomToAndShowPortal</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="DataCache.html">DataCache</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DataCache_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="DataCache.html#.window.DataCache#get">window.DataCache#get</a></li><li><a href="DataCache.html#.window.DataCache#get">window.DataCache#get</a></li><li><a href="DataCache.html#.window.DataCache#getTime">window.DataCache#getTime</a></li><li><a href="DataCache.html#.window.DataCache#getTime">window.DataCache#getTime</a></li><li><a href="DataCache.html#.window.DataCache#isFresh">window.DataCache#isFresh</a></li><li><a href="DataCache.html#.window.DataCache#isFresh">window.DataCache#isFresh</a></li><li><a href="DataCache.html#.window.DataCache#remove">window.DataCache#remove</a></li><li><a href="DataCache.html#.window.DataCache#remove">window.DataCache#remove</a></li><li><a href="DataCache.html#.window.DataCache#startExpireInterval">window.DataCache#startExpireInterval</a></li><li><a href="DataCache.html#.window.DataCache#startExpireInterval">window.DataCache#startExpireInterval</a></li><li><a href="DataCache.html#.window.DataCache#store">window.DataCache#store</a></li><li><a href="DataCache.html#.window.DataCache#store">window.DataCache#store</a></li></ul></div></li><li><a href="IITC.filters.FilterLayer.html">FilterLayer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="IITC.filters.FilterLayer_sub"></div></li><li><a href="L.html">L</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="L_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="L.html#.fileListLoader">fileListLoader</a></li><li><a href="L.html#.fileListLoader">fileListLoader</a></li><li><a href="L.html#.fileReader">fileReader</a></li><li><a href="L.html#.fileReader">fileReader</a></li></ul></div></li><li><a href="L.FileListLoader.html">FileListLoader</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="L.FileListLoader_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="L.FileListLoader.html#.loadFiles">loadFiles</a></li><li><a href="L.FileListLoader.html#.loadFiles">loadFiles</a></li></ul></div></li><li><a href="L.FileReader.html">FileReader</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="L.FileReader_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="L.FileReader.html#.loadFile">loadFile</a></li><li><a href="L.FileReader.html#.loadFile">loadFile</a></li><li><a href="L.FileReader.html#.read">read</a></li><li><a href="L.FileReader.html#.read">read</a></li></ul></div></li><li><a href="L.LayerChooser.html">LayerChooser</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="L.LayerChooser_sub"></div></li><li><a href="MapDataRequest.html">MapDataRequest</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="MapDataRequest_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="MapDataRequest.html#.window.MapDataRequest#clearTimeout">window.MapDataRequest#clearTimeout</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#clearTimeout">window.MapDataRequest#clearTimeout</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#delayProcessRequestQueue">window.MapDataRequest#delayProcessRequestQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#delayProcessRequestQueue">window.MapDataRequest#delayProcessRequestQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#getStatus">window.MapDataRequest#getStatus</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#getStatus">window.MapDataRequest#getStatus</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#handleResponse">window.MapDataRequest#handleResponse</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#handleResponse">window.MapDataRequest#handleResponse</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#idleResume">window.MapDataRequest#idleResume</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#idleResume">window.MapDataRequest#idleResume</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#mapMoveEnd">window.MapDataRequest#mapMoveEnd</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#mapMoveEnd">window.MapDataRequest#mapMoveEnd</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#mapMoveStart">window.MapDataRequest#mapMoveStart</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#mapMoveStart">window.MapDataRequest#mapMoveStart</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#pauseRenderQueue">window.MapDataRequest#pauseRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#pauseRenderQueue">window.MapDataRequest#pauseRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#processRenderQueue">window.MapDataRequest#processRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#processRenderQueue">window.MapDataRequest#processRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#processRequestQueue">window.MapDataRequest#processRequestQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#processRequestQueue">window.MapDataRequest#processRequestQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#pushRenderQueue">window.MapDataRequest#pushRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#pushRenderQueue">window.MapDataRequest#pushRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#refresh">window.MapDataRequest#refresh</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#refresh">window.MapDataRequest#refresh</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#refreshOnTimeout">window.MapDataRequest#refreshOnTimeout</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#refreshOnTimeout">window.MapDataRequest#refreshOnTimeout</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#requeueTile">window.MapDataRequest#requeueTile</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#requeueTile">window.MapDataRequest#requeueTile</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#resetRenderQueue">window.MapDataRequest#resetRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#resetRenderQueue">window.MapDataRequest#resetRenderQueue</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#sendTileRequest">window.MapDataRequest#sendTileRequest</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#sendTileRequest">window.MapDataRequest#sendTileRequest</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#setStatus">window.MapDataRequest#setStatus</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#setStatus">window.MapDataRequest#setStatus</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#start">window.MapDataRequest#start</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#start">window.MapDataRequest#start</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#startQueueTimer">window.MapDataRequest#startQueueTimer</a></li><li><a href="MapDataRequest.html#.window.MapDataRequest#startQueueTimer">window.MapDataRequest#startQueueTimer</a></li></ul></div></li><li><a href="module-region_scoreboard-RegionScore.html">RegionScore</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:region_scoreboard~RegionScore_sub"></div></li><li><a href="Render.html">Render</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Render_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Render.html#.window.Render#addPortalToMapLayer">window.Render#addPortalToMapLayer</a></li><li><a href="Render.html#.window.Render#addPortalToMapLayer">window.Render#addPortalToMapLayer</a></li><li><a href="Render.html#.window.Render#bringPortalsToFront">window.Render#bringPortalsToFront</a></li><li><a href="Render.html#.window.Render#bringPortalsToFront">window.Render#bringPortalsToFront</a></li><li><a href="Render.html#.window.Render#clearFieldsOutsideBounds">window.Render#clearFieldsOutsideBounds</a></li><li><a href="Render.html#.window.Render#clearFieldsOutsideBounds">window.Render#clearFieldsOutsideBounds</a></li><li><a href="Render.html#.window.Render#clearLinksOutsideBounds">window.Render#clearLinksOutsideBounds</a></li><li><a href="Render.html#.window.Render#clearLinksOutsideBounds">window.Render#clearLinksOutsideBounds</a></li><li><a href="Render.html#.window.Render#clearPortalsOutsideBounds">window.Render#clearPortalsOutsideBounds</a></li><li><a href="Render.html#.window.Render#clearPortalsOutsideBounds">window.Render#clearPortalsOutsideBounds</a></li><li><a href="Render.html#.window.Render#createFieldEntity">window.Render#createFieldEntity</a></li><li><a href="Render.html#.window.Render#createFieldEntity">window.Render#createFieldEntity</a></li><li><a href="Render.html#.window.Render#createLinkEntity">window.Render#createLinkEntity</a></li><li><a href="Render.html#.window.Render#createLinkEntity">window.Render#createLinkEntity</a></li><li><a href="Render.html#.window.Render#createPlaceholderPortalEntity">window.Render#createPlaceholderPortalEntity</a></li><li><a href="Render.html#.window.Render#createPlaceholderPortalEntity">window.Render#createPlaceholderPortalEntity</a></li><li><a href="Render.html#.window.Render#createPortalEntity">window.Render#createPortalEntity</a></li><li><a href="Render.html#.window.Render#createPortalEntity">window.Render#createPortalEntity</a></li><li><a href="Render.html#.window.Render#deleteEntity">window.Render#deleteEntity</a></li><li><a href="Render.html#.window.Render#deleteEntity">window.Render#deleteEntity</a></li><li><a href="Render.html#.window.Render#deleteFieldEntity">window.Render#deleteFieldEntity</a></li><li><a href="Render.html#.window.Render#deleteFieldEntity">window.Render#deleteFieldEntity</a></li><li><a href="Render.html#.window.Render#deleteLinkEntity">window.Render#deleteLinkEntity</a></li><li><a href="Render.html#.window.Render#deleteLinkEntity">window.Render#deleteLinkEntity</a></li><li><a href="Render.html#.window.Render#deletePortalEntity">window.Render#deletePortalEntity</a></li><li><a href="Render.html#.window.Render#deletePortalEntity">window.Render#deletePortalEntity</a></li><li><a href="Render.html#.window.Render#endRenderPass">window.Render#endRenderPass</a></li><li><a href="Render.html#.window.Render#endRenderPass">window.Render#endRenderPass</a></li><li><a href="Render.html#.window.Render#processDeletedGameEntityGuids">window.Render#processDeletedGameEntityGuids</a></li><li><a href="Render.html#.window.Render#processDeletedGameEntityGuids">window.Render#processDeletedGameEntityGuids</a></li><li><a href="Render.html#.window.Render#processGameEntities">window.Render#processGameEntities</a></li><li><a href="Render.html#.window.Render#processGameEntities">window.Render#processGameEntities</a></li><li><a href="Render.html#.window.Render#processTileData">window.Render#processTileData</a></li><li><a href="Render.html#.window.Render#processTileData">window.Render#processTileData</a></li><li><a href="Render.html#.window.Render#removePortalFromMapLayer">window.Render#removePortalFromMapLayer</a></li><li><a href="Render.html#.window.Render#removePortalFromMapLayer">window.Render#removePortalFromMapLayer</a></li><li><a href="Render.html#.window.Render#rescalePortalMarkers">window.Render#rescalePortalMarkers</a></li><li><a href="Render.html#.window.Render#rescalePortalMarkers">window.Render#rescalePortalMarkers</a></li><li><a href="Render.html#.window.Render#startRenderPass">window.Render#startRenderPass</a></li><li><a href="Render.html#.window.Render#startRenderPass">window.Render#startRenderPass</a></li></ul></div></li><li><a href="RenderDebugTiles.html">RenderDebugTiles</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="RenderDebugTiles_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#create">window.RenderDebugTiles#create</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#create">window.RenderDebugTiles#create</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#reset">window.RenderDebugTiles#reset</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#reset">window.RenderDebugTiles#reset</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#runClearPass">window.RenderDebugTiles#runClearPass</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#runClearPass">window.RenderDebugTiles#runClearPass</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#setColour">window.RenderDebugTiles#setColour</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#setColour">window.RenderDebugTiles#setColour</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#setState">window.RenderDebugTiles#setState</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#setState">window.RenderDebugTiles#setState</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#startTimer">window.RenderDebugTiles#startTimer</a></li><li><a href="RenderDebugTiles.html#.window.RenderDebugTiles#startTimer">window.RenderDebugTiles#startTimer</a></li></ul></div></li><li><a href="window.search.Query.html">Query</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.search.Query_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.search.Query.html#addResult">addResult</a></li><li><a href="window.search.Query.html#addResult">addResult</a></li><li><a href="window.search.Query.html#hide">hide</a></li><li><a href="window.search.Query.html#hide">hide</a></li><li><a href="window.search.Query.html#init">init</a></li><li><a href="window.search.Query.html#init">init</a></li><li><a href="window.search.Query.html#onResultHoverEnd">onResultHoverEnd</a></li><li><a href="window.search.Query.html#onResultHoverEnd">onResultHoverEnd</a></li><li><a href="window.search.Query.html#onResultHoverStart">onResultHoverStart</a></li><li><a href="window.search.Query.html#onResultHoverStart">onResultHoverStart</a></li><li><a href="window.search.Query.html#onResultSelected">onResultSelected</a></li><li><a href="window.search.Query.html#onResultSelected">onResultSelected</a></li><li><a href="window.search.Query.html#removeHoverResult">removeHoverResult</a></li><li><a href="window.search.Query.html#removeHoverResult">removeHoverResult</a></li><li><a href="window.search.Query.html#removeSelectedResult">removeSelectedResult</a></li><li><a href="window.search.Query.html#removeSelectedResult">removeSelectedResult</a></li><li><a href="window.search.Query.html#resultLayer">resultLayer</a></li><li><a href="window.search.Query.html#resultLayer">resultLayer</a></li><li><a href="window.search.Query.html#show">show</a></li><li><a href="window.search.Query.html#show">show</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Namespaces</h3><ul><li><a href="config_options.html">config_options</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="config_options_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="config_options.html#.window.ACCESS_INDICATOR_COLOR">window.ACCESS_INDICATOR_COLOR</a></li><li><a href="config_options.html#.window.ACCESS_INDICATOR_COLOR">window.ACCESS_INDICATOR_COLOR</a></li><li><a href="config_options.html#.window.CHAT_REQUEST_SCROLL_TOP">window.CHAT_REQUEST_SCROLL_TOP</a></li><li><a href="config_options.html#.window.CHAT_REQUEST_SCROLL_TOP">window.CHAT_REQUEST_SCROLL_TOP</a></li><li><a href="config_options.html#.window.CHAT_SHRINKED">window.CHAT_SHRINKED</a></li><li><a href="config_options.html#.window.CHAT_SHRINKED">window.CHAT_SHRINKED</a></li><li><a href="config_options.html#.window.COLOR_SELECTED_PORTAL">window.COLOR_SELECTED_PORTAL</a></li><li><a href="config_options.html#.window.COLOR_SELECTED_PORTAL">window.COLOR_SELECTED_PORTAL</a></li><li><a href="config_options.html#.window.COLORS">window.COLORS</a></li><li><a href="config_options.html#.window.COLORS">window.COLORS</a></li><li><a href="config_options.html#.window.COLORS_LVL">window.COLORS_LVL</a></li><li><a href="config_options.html#.window.COLORS_LVL">window.COLORS_LVL</a></li><li><a href="config_options.html#.window.COLORS_MOD">window.COLORS_MOD</a></li><li><a href="config_options.html#.window.COLORS_MOD">window.COLORS_MOD</a></li><li><a href="config_options.html#.window.DEFAULT_PORTAL_IMG">window.DEFAULT_PORTAL_IMG</a></li><li><a href="config_options.html#.window.DEFAULT_PORTAL_IMG">window.DEFAULT_PORTAL_IMG</a></li><li><a href="config_options.html#.window.DEFAULT_ZOOM">window.DEFAULT_ZOOM</a></li><li><a href="config_options.html#.window.DEFAULT_ZOOM">window.DEFAULT_ZOOM</a></li><li><a href="config_options.html#.window.HIDDEN_SCROLLBAR_ASSUMED_WIDTH">window.HIDDEN_SCROLLBAR_ASSUMED_WIDTH</a></li><li><a href="config_options.html#.window.HIDDEN_SCROLLBAR_ASSUMED_WIDTH">window.HIDDEN_SCROLLBAR_ASSUMED_WIDTH</a></li><li><a href="config_options.html#.window.MAX_IDLE_TIME">window.MAX_IDLE_TIME</a></li><li><a href="config_options.html#.window.MAX_IDLE_TIME">window.MAX_IDLE_TIME</a></li><li><a href="config_options.html#.window.MIN_ZOOM">window.MIN_ZOOM</a></li><li><a href="config_options.html#.window.MIN_ZOOM">window.MIN_ZOOM</a></li><li><a href="config_options.html#.window.MINIMUM_OVERRIDE_REFRESH">window.MINIMUM_OVERRIDE_REFRESH</a></li><li><a href="config_options.html#.window.MINIMUM_OVERRIDE_REFRESH">window.MINIMUM_OVERRIDE_REFRESH</a></li><li><a href="config_options.html#.window.NOMINATIM">window.NOMINATIM</a></li><li><a href="config_options.html#.window.NOMINATIM">window.NOMINATIM</a></li><li><a href="config_options.html#.window.ON_MOVE_REFRESH">window.ON_MOVE_REFRESH</a></li><li><a href="config_options.html#.window.ON_MOVE_REFRESH">window.ON_MOVE_REFRESH</a></li><li><a href="config_options.html#.window.RANGE_INDICATOR_COLOR">window.RANGE_INDICATOR_COLOR</a></li><li><a href="config_options.html#.window.RANGE_INDICATOR_COLOR">window.RANGE_INDICATOR_COLOR</a></li><li><a href="config_options.html#.window.REFRESH">window.REFRESH</a></li><li><a href="config_options.html#.window.REFRESH">window.REFRESH</a></li><li><a href="config_options.html#.window.REFRESH_GAME_SCORE">window.REFRESH_GAME_SCORE</a></li><li><a href="config_options.html#.window.REFRESH_GAME_SCORE">window.REFRESH_GAME_SCORE</a></li><li><a href="config_options.html#.window.SIDEBAR_WIDTH">window.SIDEBAR_WIDTH</a></li><li><a href="config_options.html#.window.SIDEBAR_WIDTH">window.SIDEBAR_WIDTH</a></li><li><a href="config_options.html#.window.ZOOM_LEVEL_ADJ">window.ZOOM_LEVEL_ADJ</a></li><li><a href="config_options.html#.window.ZOOM_LEVEL_ADJ">window.ZOOM_LEVEL_ADJ</a></li></ul></div></li><li><a href="IITC.filters.html">IITC.filters</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="IITC.filters_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="IITC.filters.html#._filters">_filters</a></li><li><a href="IITC.filters.html#._filters">_filters</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="IITC.filters.html#.filterEntities">filterEntities</a></li><li><a href="IITC.filters.html#.filterEntities">filterEntities</a></li><li><a href="IITC.filters.html#.filterField">filterField</a></li><li><a href="IITC.filters.html#.filterField">filterField</a></li><li><a href="IITC.filters.html#.filterLink">filterLink</a></li><li><a href="IITC.filters.html#.filterLink">filterLink</a></li><li><a href="IITC.filters.html#.filterPortal">filterPortal</a></li><li><a href="IITC.filters.html#.filterPortal">filterPortal</a></li><li><a href="IITC.filters.html#.has">has</a></li><li><a href="IITC.filters.html#.has">has</a></li><li><a href="IITC.filters.html#.remove">remove</a></li><li><a href="IITC.filters.html#.remove">remove</a></li><li><a href="IITC.filters.html#.set">set</a></li><li><a href="IITC.filters.html#.set">set</a></li><li><a href="IITC.filters.html#.testFilter">testFilter</a></li><li><a href="IITC.filters.html#.testFilter">testFilter</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="IITC.filters.html#.FilterDesc">FilterDesc</a></li><li><a href="IITC.filters.html#.FilterDesc">FilterDesc</a></li><li><a href="IITC.filters.html#.FilterPredicate">FilterPredicate</a></li><li><a href="IITC.filters.html#.FilterPredicate">FilterPredicate</a></li></ul></div></li><li><a href="IITC.toolbox.html">IITC.toolbox</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="IITC.toolbox_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="IITC.toolbox.html#._applySort">_applySort</a></li><li><a href="IITC.toolbox.html#._applySort">_applySort</a></li><li><a href="IITC.toolbox.html#._renderButton">_renderButton</a></li><li><a href="IITC.toolbox.html#._renderButton">_renderButton</a></li><li><a href="IITC.toolbox.html#._syncWithLegacyToolbox">_syncWithLegacyToolbox</a></li><li><a href="IITC.toolbox.html#._syncWithLegacyToolbox">_syncWithLegacyToolbox</a></li><li><a href="IITC.toolbox.html#.addButton">addButton</a></li><li><a href="IITC.toolbox.html#.addButton">addButton</a></li><li><a href="IITC.toolbox.html#.removeButton">removeButton</a></li><li><a href="IITC.toolbox.html#.removeButton">removeButton</a></li><li><a href="IITC.toolbox.html#.setSortMethod">setSortMethod</a></li><li><a href="IITC.toolbox.html#.setSortMethod">setSortMethod</a></li><li><a href="IITC.toolbox.html#.updateButton">updateButton</a></li><li><a href="IITC.toolbox.html#.updateButton">updateButton</a></li></ul></div></li><li><a href="ingress_constants.html">ingress_constants</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ingress_constants_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ingress_constants.html#.window.BASE_HACK_COOLDOWN">window.BASE_HACK_COOLDOWN</a></li><li><a href="ingress_constants.html#.window.BASE_HACK_COOLDOWN">window.BASE_HACK_COOLDOWN</a></li><li><a href="ingress_constants.html#.window.BASE_HACK_COUNT">window.BASE_HACK_COUNT</a></li><li><a href="ingress_constants.html#.window.BASE_HACK_COUNT">window.BASE_HACK_COUNT</a></li><li><a href="ingress_constants.html#.window.CAPTURE_PORTAL">window.CAPTURE_PORTAL</a></li><li><a href="ingress_constants.html#.window.CAPTURE_PORTAL">window.CAPTURE_PORTAL</a></li><li><a href="ingress_constants.html#.window.COMPLETION_BONUS">window.COMPLETION_BONUS</a></li><li><a href="ingress_constants.html#.window.COMPLETION_BONUS">window.COMPLETION_BONUS</a></li><li><a href="ingress_constants.html#.window.DEPLOY_RESONATOR">window.DEPLOY_RESONATOR</a></li><li><a href="ingress_constants.html#.window.DEPLOY_RESONATOR">window.DEPLOY_RESONATOR</a></li><li><a href="ingress_constants.html#.window.DESTROY_FIELD">window.DESTROY_FIELD</a></li><li><a href="ingress_constants.html#.window.DESTROY_FIELD">window.DESTROY_FIELD</a></li><li><a href="ingress_constants.html#.window.DESTROY_LINK">window.DESTROY_LINK</a></li><li><a href="ingress_constants.html#.window.DESTROY_LINK">window.DESTROY_LINK</a></li><li><a href="ingress_constants.html#.window.DESTROY_RESONATOR">window.DESTROY_RESONATOR</a></li><li><a href="ingress_constants.html#.window.DESTROY_RESONATOR">window.DESTROY_RESONATOR</a></li><li><a href="ingress_constants.html#.window.HACK_RANGE">window.HACK_RANGE</a></li><li><a href="ingress_constants.html#.window.HACK_RANGE">window.HACK_RANGE</a></li><li><a href="ingress_constants.html#.window.LINK_RANGE_MAC">window.LINK_RANGE_MAC</a></li><li><a href="ingress_constants.html#.window.LINK_RANGE_MAC">window.LINK_RANGE_MAC</a></li><li><a href="ingress_constants.html#.window.MAX_PORTAL_LEVEL">window.MAX_PORTAL_LEVEL</a></li><li><a href="ingress_constants.html#.window.MAX_PORTAL_LEVEL">window.MAX_PORTAL_LEVEL</a></li><li><a href="ingress_constants.html#.window.MAX_RESO_PER_PLAYER">window.MAX_RESO_PER_PLAYER</a></li><li><a href="ingress_constants.html#.window.MAX_RESO_PER_PLAYER">window.MAX_RESO_PER_PLAYER</a></li><li><a href="ingress_constants.html#.window.OCTANTS">window.OCTANTS</a></li><li><a href="ingress_constants.html#.window.OCTANTS">window.OCTANTS</a></li><li><a href="ingress_constants.html#.window.OCTANTS_ARROW">window.OCTANTS_ARROW</a></li><li><a href="ingress_constants.html#.window.OCTANTS_ARROW">window.OCTANTS_ARROW</a></li><li><a href="ingress_constants.html#.window.RESO_NRG">window.RESO_NRG</a></li><li><a href="ingress_constants.html#.window.RESO_NRG">window.RESO_NRG</a></li><li><a href="ingress_constants.html#.window.UPGRADE_ANOTHERS_RESONATOR">window.UPGRADE_ANOTHERS_RESONATOR</a></li><li><a href="ingress_constants.html#.window.UPGRADE_ANOTHERS_RESONATOR">window.UPGRADE_ANOTHERS_RESONATOR</a></li></ul></div></li><li><a href="other_constants.html">other_constants</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="other_constants_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="other_constants.html#.window.TEAM_CODE_ENL">window.TEAM_CODE_ENL</a></li><li><a href="other_constants.html#.window.TEAM_CODE_ENL">window.TEAM_CODE_ENL</a></li><li><a href="other_constants.html#.window.TEAM_CODE_MAC">window.TEAM_CODE_MAC</a></li><li><a href="other_constants.html#.window.TEAM_CODE_MAC">window.TEAM_CODE_MAC</a></li><li><a href="other_constants.html#.window.TEAM_CODE_NONE">window.TEAM_CODE_NONE</a></li><li><a href="other_constants.html#.window.TEAM_CODE_NONE">window.TEAM_CODE_NONE</a></li><li><a href="other_constants.html#.window.TEAM_CODE_RES">window.TEAM_CODE_RES</a></li><li><a href="other_constants.html#.window.TEAM_CODE_RES">window.TEAM_CODE_RES</a></li><li><a href="other_constants.html#.window.TEAM_CODENAMES">window.TEAM_CODENAMES</a></li><li><a href="other_constants.html#.window.TEAM_CODENAMES">window.TEAM_CODENAMES</a></li><li><a href="other_constants.html#.window.TEAM_CODES">window.TEAM_CODES</a></li><li><a href="other_constants.html#.window.TEAM_CODES">window.TEAM_CODES</a></li><li><a href="other_constants.html#.window.TEAM_ENL">window.TEAM_ENL</a></li><li><a href="other_constants.html#.window.TEAM_ENL">window.TEAM_ENL</a></li><li><a href="other_constants.html#.window.TEAM_MAC">window.TEAM_MAC</a></li><li><a href="other_constants.html#.window.TEAM_MAC">window.TEAM_MAC</a></li><li><a href="other_constants.html#.window.TEAM_NAME_ENL">window.TEAM_NAME_ENL</a></li><li><a href="other_constants.html#.window.TEAM_NAME_ENL">window.TEAM_NAME_ENL</a></li><li><a href="other_constants.html#.window.TEAM_NAME_MAC">window.TEAM_NAME_MAC</a></li><li><a href="other_constants.html#.window.TEAM_NAME_MAC">window.TEAM_NAME_MAC</a></li><li><a href="other_constants.html#.window.TEAM_NAME_NONE">window.TEAM_NAME_NONE</a></li><li><a href="other_constants.html#.window.TEAM_NAME_NONE">window.TEAM_NAME_NONE</a></li><li><a href="other_constants.html#.window.TEAM_NAME_RES">window.TEAM_NAME_RES</a></li><li><a href="other_constants.html#.window.TEAM_NAME_RES">window.TEAM_NAME_RES</a></li><li><a href="other_constants.html#.window.TEAM_NAMES">window.TEAM_NAMES</a></li><li><a href="other_constants.html#.window.TEAM_NAMES">window.TEAM_NAMES</a></li><li><a href="other_constants.html#.window.TEAM_NONE">window.TEAM_NONE</a></li><li><a href="other_constants.html#.window.TEAM_NONE">window.TEAM_NONE</a></li><li><a href="other_constants.html#.window.TEAM_RES">window.TEAM_RES</a></li><li><a href="other_constants.html#.window.TEAM_RES">window.TEAM_RES</a></li><li><a href="other_constants.html#.window.TEAM_TO_CSS">window.TEAM_TO_CSS</a></li><li><a href="other_constants.html#.window.TEAM_TO_CSS">window.TEAM_TO_CSS</a></li></ul></div></li><li><a href="player.html">player</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="player_sub"><div class="member-type">Typedef</div><ul class="inner"><li><a href="player.html#.PLAYER">PLAYER</a></li><li><a href="player.html#.PLAYER">PLAYER</a></li></ul></div></li><li><a href="storage_variables.html">storage_variables</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="storage_variables_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="storage_variables.html#.window.fields">window.fields</a></li><li><a href="storage_variables.html#.window.fields">window.fields</a></li><li><a href="storage_variables.html#.window.links">window.links</a></li><li><a href="storage_variables.html#.window.links">window.links</a></li><li><a href="storage_variables.html#.window.portalAccessIndicator">window.portalAccessIndicator</a></li><li><a href="storage_variables.html#.window.portalAccessIndicator">window.portalAccessIndicator</a></li><li><a href="storage_variables.html#.window.portalRangeIndicator">window.portalRangeIndicator</a></li><li><a href="storage_variables.html#.window.portalRangeIndicator">window.portalRangeIndicator</a></li><li><a href="storage_variables.html#.window.portals">window.portals</a></li><li><a href="storage_variables.html#.window.portals">window.portals</a></li><li><a href="storage_variables.html#.window.refreshTimeout">window.refreshTimeout</a></li><li><a href="storage_variables.html#.window.refreshTimeout">window.refreshTimeout</a></li><li><a href="storage_variables.html#.window.selectedPortal">window.selectedPortal</a></li><li><a href="storage_variables.html#.window.selectedPortal">window.selectedPortal</a></li><li><a href="storage_variables.html#.window.urlPortal">window.urlPortal</a></li><li><a href="storage_variables.html#.window.urlPortal">window.urlPortal</a></li><li><a href="storage_variables.html#.window.urlPortalLL">window.urlPortalLL</a></li><li><a href="storage_variables.html#.window.urlPortalLL">window.urlPortalLL</a></li></ul></div></li><li><a href="window.artifact.html">window.artifact</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.artifact_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.artifact.html#.clearData">clearData</a></li><li><a href="window.artifact.html#.clearData">clearData</a></li><li><a href="window.artifact.html#.getArtifactEntities">getArtifactEntities</a></li><li><a href="window.artifact.html#.getArtifactEntities">getArtifactEntities</a></li><li><a href="window.artifact.html#.getArtifactTypes">getArtifactTypes</a></li><li><a href="window.artifact.html#.getArtifactTypes">getArtifactTypes</a></li><li><a href="window.artifact.html#.getInterestingPortals">getInterestingPortals</a></li><li><a href="window.artifact.html#.getInterestingPortals">getInterestingPortals</a></li><li><a href="window.artifact.html#.getPortalData">getPortalData</a></li><li><a href="window.artifact.html#.getPortalData">getPortalData</a></li><li><a href="window.artifact.html#.handleFailure">handleFailure</a></li><li><a href="window.artifact.html#.handleFailure">handleFailure</a></li><li><a href="window.artifact.html#.handleSuccess">handleSuccess</a></li><li><a href="window.artifact.html#.handleSuccess">handleSuccess</a></li><li><a href="window.artifact.html#.idleResume">idleResume</a></li><li><a href="window.artifact.html#.idleResume">idleResume</a></li><li><a href="window.artifact.html#.isArtifact">isArtifact</a></li><li><a href="window.artifact.html#.isArtifact">isArtifact</a></li><li><a href="window.artifact.html#.isInterestingPortal">isInterestingPortal</a></li><li><a href="window.artifact.html#.isInterestingPortal">isInterestingPortal</a></li><li><a href="window.artifact.html#.processData">processData</a></li><li><a href="window.artifact.html#.processData">processData</a></li><li><a href="window.artifact.html#.processResult">processResult</a></li><li><a href="window.artifact.html#.processResult">processResult</a></li><li><a href="window.artifact.html#.requestData">requestData</a></li><li><a href="window.artifact.html#.requestData">requestData</a></li><li><a href="window.artifact.html#.setup">setup</a></li><li><a href="window.artifact.html#.setup">setup</a></li><li><a href="window.artifact.html#.showArtifactList">showArtifactList</a></li><li><a href="window.artifact.html#.showArtifactList">showArtifactList</a></li><li><a href="window.artifact.html#.updateLayer">updateLayer</a></li><li><a href="window.artifact.html#.updateLayer">updateLayer</a></li></ul></div></li><li><a href="window.chat.html">window.chat</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.chat_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="window.chat.html#._alerts">_alerts</a></li><li><a href="window.chat.html#._alerts">_alerts</a></li><li><a href="window.chat.html#._faction">_faction</a></li><li><a href="window.chat.html#._faction">_faction</a></li><li><a href="window.chat.html#._public">_public</a></li><li><a href="window.chat.html#._public">_public</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="window.chat.html#.addNickname">addNickname</a></li><li><a href="window.chat.html#.addNickname">addNickname</a></li><li><a href="window.chat.html#.backgroundChannelData">backgroundChannelData</a></li><li><a href="window.chat.html#.backgroundChannelData">backgroundChannelData</a></li><li><a href="window.chat.html#.chooser">chooser</a></li><li><a href="window.chat.html#.chooser">chooser</a></li><li><a href="window.chat.html#.chooseTab">chooseTab</a></li><li><a href="window.chat.html#.chooseTab">chooseTab</a></li><li><a href="window.chat.html#.genPostData">genPostData</a></li><li><a href="window.chat.html#.genPostData">genPostData</a></li><li><a href="window.chat.html#.getActive">getActive</a></li><li><a href="window.chat.html#.getActive">getActive</a></li><li><a href="window.chat.html#.getChatPortalName">getChatPortalName</a></li><li><a href="window.chat.html#.getChatPortalName">getChatPortalName</a></li><li><a href="window.chat.html#.handleAlerts">handleAlerts</a></li><li><a href="window.chat.html#.handleAlerts">handleAlerts</a></li><li><a href="window.chat.html#.handleFaction">handleFaction</a></li><li><a href="window.chat.html#.handleFaction">handleFaction</a></li><li><a href="window.chat.html#.handlePublic">handlePublic</a></li><li><a href="window.chat.html#.handlePublic">handlePublic</a></li><li><a href="window.chat.html#.handleTabCompletion">handleTabCompletion</a></li><li><a href="window.chat.html#.handleTabCompletion">handleTabCompletion</a></li><li><a href="window.chat.html#.keepScrollPosition">keepScrollPosition</a></li><li><a href="window.chat.html#.keepScrollPosition">keepScrollPosition</a></li><li><a href="window.chat.html#.needMoreMessages">needMoreMessages</a></li><li><a href="window.chat.html#.needMoreMessages">needMoreMessages</a></li><li><a href="window.chat.html#.nicknameClicked">nicknameClicked</a></li><li><a href="window.chat.html#.nicknameClicked">nicknameClicked</a></li><li><a href="window.chat.html#.parseMsgData">parseMsgData</a></li><li><a href="window.chat.html#.parseMsgData">parseMsgData</a></li><li><a href="window.chat.html#.postMsg">postMsg</a></li><li><a href="window.chat.html#.postMsg">postMsg</a></li><li><a href="window.chat.html#.renderAlerts">renderAlerts</a></li><li><a href="window.chat.html#.renderAlerts">renderAlerts</a></li><li><a href="window.chat.html#.renderData">renderData</a></li><li><a href="window.chat.html#.renderData">renderData</a></li><li><a href="window.chat.html#.renderDivider">renderDivider</a></li><li><a href="window.chat.html#.renderDivider">renderDivider</a></li><li><a href="window.chat.html#.renderFaction">renderFaction</a></li><li><a href="window.chat.html#.renderFaction">renderFaction</a></li><li><a href="window.chat.html#.renderFactionEnt">renderFactionEnt</a></li><li><a href="window.chat.html#.renderFactionEnt">renderFactionEnt</a></li><li><a href="window.chat.html#.renderMarkup">renderMarkup</a></li><li><a href="window.chat.html#.renderMarkup">renderMarkup</a></li><li><a href="window.chat.html#.renderMarkupEntity">renderMarkupEntity</a></li><li><a href="window.chat.html#.renderMarkupEntity">renderMarkupEntity</a></li><li><a href="window.chat.html#.renderMsg">renderMsg</a></li><li><a href="window.chat.html#.renderMsg">renderMsg</a></li><li><a href="window.chat.html#.renderMsgCell">renderMsgCell</a></li><li><a href="window.chat.html#.renderMsgCell">renderMsgCell</a></li><li><a href="window.chat.html#.renderMsgRow">renderMsgRow</a></li><li><a href="window.chat.html#.renderMsgRow">renderMsgRow</a></li><li><a href="window.chat.html#.renderNickCell">renderNickCell</a></li><li><a href="window.chat.html#.renderNickCell">renderNickCell</a></li><li><a href="window.chat.html#.renderPlayer">renderPlayer</a></li><li><a href="window.chat.html#.renderPlayer">renderPlayer</a></li><li><a href="window.chat.html#.renderPortal">renderPortal</a></li><li><a href="window.chat.html#.renderPortal">renderPortal</a></li><li><a href="window.chat.html#.renderPublic">renderPublic</a></li><li><a href="window.chat.html#.renderPublic">renderPublic</a></li><li><a href="window.chat.html#.renderText">renderText</a></li><li><a href="window.chat.html#.renderText">renderText</a></li><li><a href="window.chat.html#.renderTimeCell">renderTimeCell</a></li><li><a href="window.chat.html#.renderTimeCell">renderTimeCell</a></li><li><a href="window.chat.html#.request">request</a></li><li><a href="window.chat.html#.request">request</a></li><li><a href="window.chat.html#.requestAlerts">requestAlerts</a></li><li><a href="window.chat.html#.requestAlerts">requestAlerts</a></li><li><a href="window.chat.html#.requestFaction">requestFaction</a></li><li><a href="window.chat.html#.requestFaction">requestFaction</a></li><li><a href="window.chat.html#.requestPublic">requestPublic</a></li><li><a href="window.chat.html#.requestPublic">requestPublic</a></li><li><a href="window.chat.html#.setup">setup</a></li><li><a href="window.chat.html#.setup">setup</a></li><li><a href="window.chat.html#.setupPosting">setupPosting</a></li><li><a href="window.chat.html#.setupPosting">setupPosting</a></li><li><a href="window.chat.html#.setupTime">setupTime</a></li><li><a href="window.chat.html#.setupTime">setupTime</a></li><li><a href="window.chat.html#.show">show</a></li><li><a href="window.chat.html#.show">show</a></li><li><a href="window.chat.html#.tabToChannel">tabToChannel</a></li><li><a href="window.chat.html#.tabToChannel">tabToChannel</a></li><li><a href="window.chat.html#.toggle">toggle</a></li><li><a href="window.chat.html#.toggle">toggle</a></li><li><a href="window.chat.html#.transformMessage">transformMessage</a></li><li><a href="window.chat.html#.transformMessage">transformMessage</a></li><li><a href="window.chat.html#.updateOldNewHash">updateOldNewHash</a></li><li><a href="window.chat.html#.updateOldNewHash">updateOldNewHash</a></li><li><a href="window.chat.html#.writeDataToHash">writeDataToHash</a></li><li><a href="window.chat.html#.writeDataToHash">writeDataToHash</a></li></ul></div></li><li><a href="window.decodeArray.html">window.decodeArray</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.decodeArray_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.decodeArray.html#.portal">portal</a></li><li><a href="window.decodeArray.html#.portal">portal</a></li></ul></div></li><li><a href="window.ornaments.html">window.ornaments</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.ornaments_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="window.ornaments.html#.excludedOrnaments">excludedOrnaments</a></li><li><a href="window.ornaments.html#.excludedOrnaments">excludedOrnaments</a></li><li><a href="window.ornaments.html#.icon">icon</a></li><li><a href="window.ornaments.html#.icon">icon</a></li><li><a href="window.ornaments.html#.knownOrnaments">knownOrnaments</a></li><li><a href="window.ornaments.html#.knownOrnaments">knownOrnaments</a></li><li><a href="window.ornaments.html#.OVERLAY_OPACITY">OVERLAY_OPACITY</a></li><li><a href="window.ornaments.html#.OVERLAY_OPACITY">OVERLAY_OPACITY</a></li><li><a href="window.ornaments.html#.OVERLAY_SIZE">OVERLAY_SIZE</a></li><li><a href="window.ornaments.html#.OVERLAY_SIZE">OVERLAY_SIZE</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="window.ornaments.html#.addPortal">addPortal</a></li><li><a href="window.ornaments.html#.addPortal">addPortal</a></li><li><a href="window.ornaments.html#.createLayer">createLayer</a></li><li><a href="window.ornaments.html#.createLayer">createLayer</a></li><li><a href="window.ornaments.html#.initOrnaments">initOrnaments</a></li><li><a href="window.ornaments.html#.initOrnaments">initOrnaments</a></li><li><a href="window.ornaments.html#.load">load</a></li><li><a href="window.ornaments.html#.load">load</a></li><li><a href="window.ornaments.html#.onChangeHandler">onChangeHandler</a></li><li><a href="window.ornaments.html#.onChangeHandler">onChangeHandler</a></li><li><a href="window.ornaments.html#.ornamentsList">ornamentsList</a></li><li><a href="window.ornaments.html#.ornamentsList">ornamentsList</a></li><li><a href="window.ornaments.html#.ornamentsOpt">ornamentsOpt</a></li><li><a href="window.ornaments.html#.ornamentsOpt">ornamentsOpt</a></li><li><a href="window.ornaments.html#.processInput">processInput</a></li><li><a href="window.ornaments.html#.processInput">processInput</a></li><li><a href="window.ornaments.html#.reload">reload</a></li><li><a href="window.ornaments.html#.reload">reload</a></li><li><a href="window.ornaments.html#.removePortal">removePortal</a></li><li><a href="window.ornaments.html#.removePortal">removePortal</a></li><li><a href="window.ornaments.html#.replaceOL">replaceOL</a></li><li><a href="window.ornaments.html#.replaceOL">replaceOL</a></li><li><a href="window.ornaments.html#.save">save</a></li><li><a href="window.ornaments.html#.save">save</a></li><li><a href="window.ornaments.html#.setup">setup</a></li><li><a href="window.ornaments.html#.setup">setup</a></li></ul></div></li><li><a href="window.portalDetail.html">window.portalDetail</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.portalDetail_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.portalDetail.html#.get">get</a></li><li><a href="window.portalDetail.html#.get">get</a></li><li><a href="window.portalDetail.html#.isFresh">isFresh</a></li><li><a href="window.portalDetail.html#.isFresh">isFresh</a></li><li><a href="window.portalDetail.html#.request">request</a></li><li><a href="window.portalDetail.html#.request">request</a></li><li><a href="window.portalDetail.html#.setup">setup</a></li><li><a href="window.portalDetail.html#.setup">setup</a></li><li><a href="window.portalDetail.html#.store">store</a></li><li><a href="window.portalDetail.html#.store">store</a></li></ul></div></li><li><a href="window.requests.html">window.requests</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.requests_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.requests.html#._callOnRefreshFunctions">_callOnRefreshFunctions</a></li><li><a href="window.requests.html#._callOnRefreshFunctions">_callOnRefreshFunctions</a></li><li><a href="window.requests.html#.abort">abort</a></li><li><a href="window.requests.html#.abort">abort</a></li><li><a href="window.requests.html#.add">add</a></li><li><a href="window.requests.html#.add">add</a></li><li><a href="window.requests.html#.addRefreshFunction">addRefreshFunction</a></li><li><a href="window.requests.html#.addRefreshFunction">addRefreshFunction</a></li><li><a href="window.requests.html#.remove">remove</a></li><li><a href="window.requests.html#.remove">remove</a></li></ul></div></li><li><a href="window.search.html">window.search</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="window.search_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="window.search.html#.addSearchResult">addSearchResult</a></li><li><a href="window.search.html#.addSearchResult">addSearchResult</a></li><li><a href="window.search.html#.doSearch">doSearch</a></li><li><a href="window.search.html#.doSearch">doSearch</a></li><li><a href="window.search.html#.setup">setup</a></li><li><a href="window.search.html#.setup">setup</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3><a href="global.html">Global</a></h3></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Namespace for chat-related functionalities.
 * @namespace window.chat
 */

window.chat = function () {};
var chat = window.chat;

/**
 * Handles tab completion in chat input.
 *
 * @function window.chat.handleTabCompletion
 */
window.chat.handleTabCompletion = function() {
  var el = $('#chatinput input');
  var curPos = el.get(0).selectionStart;
  var text = el.val();
  var word = text.slice(0, curPos).replace(/.*\b([a-z0-9-_])/, '$1').toLowerCase();

  var list = $('#chat > div:visible mark');
  list = list.map(function(ind, mark) { return $(mark).text(); } );
  list = uniqueArray(list);

  var nick = null;
  for(var i = 0; i &lt; list.length; i++) {
    if(!list[i].toLowerCase().startsWith(word)) continue;
    if(nick &amp;&amp; nick !== list[i]) {
      log.warn('More than one nick matches, aborting. ('+list[i]+' vs '+nick+')');
      return;
    }
    nick = list[i];
  }
  if(!nick) {
    return;
  }

  var posStart = curPos - word.length;
  var newText = text.substring(0, posStart);
  var atPresent = text.substring(posStart-1, posStart) === '@';
  newText += (atPresent ? '' : '@') + nick + ' ';
  newText += text.substring(curPos);
  el.val(newText);
}

//
// clear management
//


window.chat._oldBBox = null;

/**
 * Generates post data for chat requests.
 *
 * @function window.chat.genPostData
 * @param {string} channel - The chat channel.
 * @param {Object} storageHash - Storage hash for the chat.
 * @param {boolean} getOlderMsgs - Flag to determine if older messages are being requested.
 * @returns {Object} The generated post data.
 */
window.chat.genPostData = function(channel, storageHash, getOlderMsgs) {
  if (typeof channel !== 'string') {
    throw new Error('API changed: isFaction flag now a channel string - all, faction, alerts');
  }

  var b = clampLatLngBounds(map.getBounds());

  // set a current bounding box if none set so far
  if (!chat._oldBBox) chat._oldBBox = b;

  // to avoid unnecessary chat refreshes, a small difference compared to the previous bounding box
  // is not considered different
  var CHAT_BOUNDINGBOX_SAME_FACTOR = 0.1;
  // if the old and new box contain each other, after expanding by the factor, don't reset chat
  if (!(b.pad(CHAT_BOUNDINGBOX_SAME_FACTOR).contains(chat._oldBBox) &amp;&amp; chat._oldBBox.pad(CHAT_BOUNDINGBOX_SAME_FACTOR).contains(b))) {
    log.log('Bounding Box changed, chat will be cleared (old: '+chat._oldBBox.toBBoxString()+'; new: '+b.toBBoxString()+')');

    $('#chat > div').data('needsClearing', true);

    // need to reset these flags now because clearing will only occur
    // after the request is finished – i.e. there would be one almost
    // useless request.
    chat._faction.data = {};
    chat._faction.guids = [];
    chat._faction.oldestTimestamp = -1;
    chat._faction.newestTimestamp = -1;
    delete chat._faction.oldestGUID;
    delete chat._faction.newestGUID;

    chat._public.data = {};
    chat._public.guids = [];
    chat._public.oldestTimestamp = -1;
    chat._public.newestTimestamp = -1;
    delete chat._public.oldestGUID;
    delete chat._public.newestGUID;

    chat._alerts.data = {};
    chat._alerts.guids = [];
    chat._alerts.oldestTimestamp = -1;
    chat._alerts.newestTimestamp = -1;
    delete chat._alerts.oldestGUID;
    delete chat._alerts.newestGUID;

    chat._oldBBox = b;
  }

  var ne = b.getNorthEast();
  var sw = b.getSouthWest();
  var data = {
    minLatE6: Math.round(sw.lat*1E6),
    minLngE6: Math.round(sw.lng*1E6),
    maxLatE6: Math.round(ne.lat*1E6),
    maxLngE6: Math.round(ne.lng*1E6),
    minTimestampMs: -1,
    maxTimestampMs: -1,
    tab: channel,
  };

  if (getOlderMsgs) {
    // ask for older chat when scrolling up
    data = $.extend(data, {
      maxTimestampMs: storageHash.oldestTimestamp,
      plextContinuationGuid: storageHash.oldestGUID
    });
  } else {
    // ask for newer chat
    var min = storageHash.newestTimestamp;
    // the initial request will have both timestamp values set to -1,
    // thus we receive the newest 50. After that, we will only receive
    // messages with a timestamp greater or equal to min above.
    // After resuming from idle, there might be more new messages than
    // desiredNumItems. So on the first request, we are not really up to
    // date. We will eventually catch up, as long as there are less new
    // messages than 50 per each refresh cycle.
    // A proper solution would be to query until no more new results are
    // returned.
    // Currently this edge case is not handled. Let’s see if this is a
    // problem in crowded areas.
    $.extend(data, {
      minTimestampMs: min,
      plextContinuationGuid: storageHash.newestGUID
    });
    // when requesting with an actual minimum timestamp, request oldest rather than newest first.
    // this matches the stock intel site, and ensures no gaps when continuing after an extended idle period
    if (min > -1) $.extend(data, {ascendingTimestampOrder: true});
  }
  return data;
};



//
// faction
//

window.chat._requestFactionRunning = false;

/**
 * Requests faction chat messages.
 *
 * @function window.chat.requestFaction
 * @param {boolean} getOlderMsgs - Flag to determine if older messages are being requested.
 * @param {boolean} [isRetry=false] - Flag to indicate if this is a retry attempt.
 */
window.chat.requestFaction = function(getOlderMsgs, isRetry) {
  if(chat._requestFactionRunning &amp;&amp; !isRetry) return;
  if(isIdle()) return renderUpdateStatus();
  chat._requestFactionRunning = true;
  $("#chatcontrols a:contains('faction')").addClass('loading');

  var d = chat.genPostData('faction', chat._faction, getOlderMsgs);
  var r = window.postAjax(
    'getPlexts',
    d,
    function(data, textStatus, jqXHR) { chat.handleFaction(data, getOlderMsgs, d.ascendingTimestampOrder); },
    isRetry
      ? function() { window.chat._requestFactionRunning = false; }
      : function() { window.chat.requestFaction(getOlderMsgs, true) }
  );
}

/**
 * Holds data related to faction chat.
 *
 * @memberof window.chat
 * @type {Object}
 */
window.chat._faction = {data:{}, guids: [], oldestTimestamp:-1, newestTimestamp:-1};

/**
 * Handles faction chat response.
 *
 * @function window.chat.handleFaction
 * @param {Object} data - Response data from server.
 * @param {boolean} olderMsgs - Indicates if older messages were requested.
 * @param {boolean} ascendingTimestampOrder - Indicates if messages are in ascending timestamp order.
 */
window.chat.handleFaction = function(data, olderMsgs, ascendingTimestampOrder) {
  chat._requestFactionRunning = false;
  $("#chatcontrols a:contains('faction')").removeClass('loading');

  if(!data || !data.result) {
    window.failedRequestCount++;
    return log.warn('faction chat error. Waiting for next auto-refresh.');
  }

  if (!data.result.length &amp;&amp; !$('#chatfaction').data('needsClearing')) {
    // no new data and current data in chat._faction.data is already rendered
    return;
  }

  $('#chatfaction').data('needsClearing', null);

  var old = chat._faction.oldestGUID;
  chat.writeDataToHash(data, chat._faction, olderMsgs, ascendingTimestampOrder);
  var oldMsgsWereAdded = old !== chat._faction.oldestGUID;

  runHooks('factionChatDataAvailable', {raw: data, result: data.result, processed: chat._faction.data});

  window.chat.renderFaction(oldMsgsWereAdded);
}

/**
 * Renders faction chat.
 *
 * @function window.chat.renderFaction
 * @param {boolean} oldMsgsWereAdded - Indicates if old messages were added in the current rendering.
 */
window.chat.renderFaction = function(oldMsgsWereAdded) {
  chat.renderData(chat._faction.data, 'chatfaction', oldMsgsWereAdded, chat._faction.guids);
}


//
// all
//

window.chat._requestPublicRunning = false;

/**
 * Initiates a request for public chat data.
 *
 * @function window.chat.requestPublic
 * @param {boolean} getOlderMsgs - Whether to retrieve older messages.
 * @param {boolean} [isRetry=false] - Whether the request is a retry.
 */
window.chat.requestPublic = function(getOlderMsgs, isRetry) {
  if(chat._requestPublicRunning &amp;&amp; !isRetry) return;
  if(isIdle()) return renderUpdateStatus();
  chat._requestPublicRunning = true;
  $("#chatcontrols a:contains('all')").addClass('loading');

  var d = chat.genPostData('all', chat._public, getOlderMsgs);
  var r = window.postAjax(
    'getPlexts',
    d,
    function(data, textStatus, jqXHR) { chat.handlePublic(data, getOlderMsgs, d.ascendingTimestampOrder); },
    isRetry
      ? function() { window.chat._requestPublicRunning = false; }
      : function() { window.chat.requestPublic(getOlderMsgs, true) }
  );
}

/**
 * Holds data related to public chat.
 *
 * @memberof window.chat
 * @type {Object}
 */
window.chat._public = {data:{}, guids: [], oldestTimestamp:-1, newestTimestamp:-1};

/**
 * Handles the public chat data received from the server.
 *
 * @function window.chat.handlePublic
 * @param {Object} data - The public chat data.
 * @param {boolean} olderMsgs - Whether the received messages are older.
 * @param {boolean} ascendingTimestampOrder - Whether messages are in ascending timestamp order.
 */
window.chat.handlePublic = function(data, olderMsgs, ascendingTimestampOrder) {
  chat._requestPublicRunning = false;
  $("#chatcontrols a:contains('all')").removeClass('loading');

  if(!data || !data.result) {
    window.failedRequestCount++;
    return log.warn('public chat error. Waiting for next auto-refresh.');
  }

  if (!data.result.length &amp;&amp; !$('#chatall').data('needsClearing')) {
    // no new data and current data in chat._public.data is already rendered
    return;
  }

  $('#chatall').data('needsClearing', null);

  var old = chat._public.oldestGUID;
  chat.writeDataToHash(data, chat._public, olderMsgs, ascendingTimestampOrder);
  var oldMsgsWereAdded = old !== chat._public.oldestGUID;

  runHooks('publicChatDataAvailable', {raw: data, result: data.result, processed: chat._public.data});

  window.chat.renderPublic(oldMsgsWereAdded);

}

/**
 * Renders public chat in the UI.
 *
 * @function window.chat.renderPublic
 * @param {boolean} oldMsgsWereAdded - Indicates if older messages were added to the chat.
 */
window.chat.renderPublic = function(oldMsgsWereAdded) {
  chat.renderData(chat._public.data, 'chatall', oldMsgsWereAdded, chat._public.guids);
}


//
// alerts
//

window.chat._requestAlertsRunning = false;

/**
 * Initiates a request for alerts chat data.
 *
 * @function window.chat.requestAlerts
 * @param {boolean} getOlderMsgs - Whether to retrieve older messages.
 * @param {boolean} [isRetry=false] - Whether the request is a retry.
 */
window.chat.requestAlerts = function(getOlderMsgs, isRetry) {
  if(chat._requestAlertsRunning &amp;&amp; !isRetry) return;
  if(isIdle()) return renderUpdateStatus();
  chat._requestAlertsRunning = true;
  $("#chatcontrols a:contains('alerts')").addClass('loading');

  var d = chat.genPostData('alerts', chat._alerts, getOlderMsgs);
  var r = window.postAjax(
    'getPlexts',
    d,
    function(data, textStatus, jqXHR) { chat.handleAlerts(data, getOlderMsgs, d.ascendingTimestampOrder); },
    isRetry
      ? function() { window.chat._requestAlertsRunning = false; }
      : function() { window.chat.requestAlerts(getOlderMsgs, true) }
  );
}

/**
 * Holds data related to alerts chat.
 *
 * @memberof window.chat
 * @type {Object}
 */
window.chat._alerts = {data:{}, guids: [], oldestTimestamp:-1, newestTimestamp:-1};

/**
 * Handles the alerts chat data received from the server.
 *
 * @function window.chat.handleAlerts
 * @param {Object} data - The alerts chat data.
 * @param {boolean} olderMsgs - Whether the received messages are older.
 * @param {boolean} ascendingTimestampOrder - Whether messages are in ascending timestamp order.
 */
window.chat.handleAlerts = function(data, olderMsgs, ascendingTimestampOrder) {
  chat._requestAlertsRunning = false;
  $("#chatcontrols a:contains('alerts')").removeClass('loading');

  if(!data || !data.result) {
    window.failedRequestCount++;
    return log.warn('alerts chat error. Waiting for next auto-refresh.');
  }

  if(data.result.length === 0) return;

  var old = chat._alerts.oldestTimestamp;
  chat.writeDataToHash(data, chat._alerts, olderMsgs, ascendingTimestampOrder);
  var oldMsgsWereAdded = old !== chat._alerts.oldestTimestamp;

  // hook for alerts - API change planned here for next refactor
  runHooks('alertsChatDataAvailable', {raw: data, result: data.result, processed: chat._alerts.data});

  window.chat.renderAlerts(oldMsgsWereAdded);
}

/**
 * Renders alerts chat in the UI.
 *
 * @function window.chat.renderAlerts
 * @param {boolean} oldMsgsWereAdded - Indicates if older messages were added to the chat.
 */
window.chat.renderAlerts = function(oldMsgsWereAdded) {
  chat.renderData(chat._alerts.data, 'chatalerts', oldMsgsWereAdded, chat._alerts.guids);
}



//
// common
//

/**
 * Adds a nickname to the chat input.
 *
 * @function window.chat.addNickname
 * @param {string} nick - The nickname to add.
 */
window.chat.addNickname= function(nick) {
  var c = document.getElementById("chattext");
  c.value = [c.value.trim(), nick].join(" ").trim() + " ";
  c.focus()
}

/**
 * Handles click events on nicknames in the chat.
 *
 * @function window.chat.nicknameClicked
 * @param {Event} event - The click event.
 * @param {string} nickname - The clicked nickname.
 * @returns {boolean} Always returns false.
 */
window.chat.nicknameClicked = function(event, nickname) {
  var hookData = { event: event, nickname: nickname };

  if (window.runHooks('nicknameClicked', hookData)) {
    window.chat.addNickname('@' + nickname);
  }

  event.preventDefault();
  event.stopPropagation();
  return false;
}

/**
 * Updates the oldest and newest message timestamps and GUIDs in the chat storage.
 *
 * @function window.chat.updateOldNewHash
 * @param {Object} newData - The new chat data received.
 * @param {Object} storageHash - The chat storage object.
 * @param {boolean} isOlderMsgs - Whether the new data contains older messages.
 * @param {boolean} isAscendingOrder - Whether the new data is in ascending order.
 */
window.chat.updateOldNewHash = function(newData, storageHash, isOlderMsgs, isAscendingOrder) {
  // track oldest + newest timestamps/GUID
  if (newData.result.length > 0) {
    var first = {
      guid: newData.result[0][0],
      time: newData.result[0][1]
    };
    var last = {
      guid: newData.result[newData.result.length-1][0],
      time: newData.result[newData.result.length-1][1]
    };
    if (isAscendingOrder) {
      var temp = first;
      first = last;
      last = temp;
    }
    if (storageHash.oldestTimestamp === -1 || storageHash.oldestTimestamp >= last.time) {
      if (isOlderMsgs || storageHash.oldestTimestamp !== last.time) {
        storageHash.oldestTimestamp = last.time;
        storageHash.oldestGUID = last.guid;
      }
    }
    if (storageHash.newestTimestamp === -1 || storageHash.newestTimestamp &lt;= first.time) {
      if (!isOlderMsgs || storageHash.newestTimestamp !== first.time) {
        storageHash.newestTimestamp = first.time;
        storageHash.newestGUID = first.guid;
      }
    }
  }
};

/**
 * Parses chat message data into a more convenient format.
 *
 * @function window.chat.parseMsgData
 * @param {Object} data - The raw chat message data.
 * @returns {Object} The parsed chat message data.
 */
window.chat.parseMsgData = function (data) {
  var categories = data[2].plext.categories;
  var isPublic = (categories &amp; 1) === 1;
  var isSecure = (categories &amp; 2) === 2;
  var msgAlert = (categories &amp; 4) === 4;

  var msgToPlayer = msgAlert &amp;&amp; (isPublic || isSecure);

  var time = data[1];
  var team = window.teamStringToId(data[2].plext.team);
  var auto = data[2].plext.plextType !== 'PLAYER_GENERATED';
  var systemNarrowcast = data[2].plext.plextType === 'SYSTEM_NARROWCAST';

  var markup = data[2].plext.markup;

  var player = {
    name: '',
    team: team,
  };
  markup.forEach(function(ent) {
    switch (ent[0]) {
      case 'SENDER': // user generated messages
        player.name = ent[1].plain.replace(/: $/, ''); // cut “: ” at end
        break;

      case 'PLAYER': // automatically generated messages
        player.name = ent[1].plain;
        player.team = window.teamStringToId(ent[1].team);
        break;

      default:
        break;
    }
  });

  return {
    guid: data[0],
    time: time,
    public: isPublic,
    secure: isSecure,
    alert: msgAlert,
    msgToPlayer: msgToPlayer,
    type: data[2].plext.plextType,
    narrowcast: systemNarrowcast,
    auto: auto,
    team: team,
    player: player,
    markup: markup,
  };
};

/**
 * Writes new chat data to the chat storage and manages the order of messages.
 *
 * @function window.chat.writeDataToHash
 * @param {Object} newData - The new chat data received.
 * @param {Object} storageHash - The chat storage object.
 * @param {boolean} isOlderMsgs - Whether the new data contains older messages.
 * @param {boolean} isAscendingOrder - Whether the new data is in ascending order.
 */
window.chat.writeDataToHash = function (newData, storageHash, isOlderMsgs, isAscendingOrder) {
  window.chat.updateOldNewHash(newData, storageHash, isOlderMsgs, isAscendingOrder);

  newData.result.forEach(function(json) {
    // avoid duplicates
    if (json[0] in storageHash.data) {
      return true;
    }

    var parsedData = chat.parseMsgData(json);

    // format: timestamp, autogenerated, HTML message, nick, additional data (parsed, plugin specific data...)
    storageHash.data[parsedData.guid] = [parsedData.time, parsedData.auto, chat.renderMsgRow(parsedData), parsedData.player.name, parsedData];
    if (isAscendingOrder) {
      storageHash.guids.push(parsedData.guid);
    } else {
      storageHash.guids.unshift(parsedData.guid);
    }
  });
};

//
// Rendering primitive for markup, chat cells (td) and chat row (tr)
//

/**
 * Renders text for the chat, converting plain text to HTML and adding links.
 *
 * @function window.chat.renderText
 * @param {Object} text - An object containing the plain text to render.
 * @returns {string} The rendered HTML string.
 */
window.chat.renderText = function (text) {
  let content;

  if (text.team) {
    let teamId = window.teamStringToId(text.team);
    if (teamId === window.TEAM_NONE) teamId = window.TEAM_MAC;
    const spanClass = window.TEAM_TO_CSS[teamId];
    content = $('&lt;div>').append($('&lt;span>', { class: spanClass, text: text.plain }));
  } else {
    content = $('&lt;div>').text(text.plain);
  }

  return content.html().autoLink();
};

/**
 * Overrides portal names used repeatedly in chat, such as 'US Post Office', with more specific names.
 *
 * @function window.chat.getChatPortalName
 * @param {Object} markup - An object containing portal markup, including the name and address.
 * @returns {string} The processed portal name.
 */
window.chat.getChatPortalName = function (markup) {
  var name = markup.name;
  if (name === 'US Post Office') {
    var address = markup.address.split(',');
    name = 'USPS: ' + address[0];
  }
  return name;
};

/**
 * Renders a portal link for use in the chat.
 *
 * @function window.chat.renderPortal
 * @param {Object} portal - The portal data.
 * @returns {string} HTML string of the portal link.
 */
window.chat.renderPortal = function (portal) {
  var lat = portal.latE6/1E6, lng = portal.lngE6/1E6;
  var perma = window.makePermalink([lat,lng]);
  var js = 'window.selectPortalByLatLng('+lat+', '+lng+');return false';
  return '&lt;a onclick="' + js + '"' + ' title="' + portal.address + '"' + ' href="' + perma + '" class="help">' + window.chat.getChatPortalName(portal) + '&lt;/a>';
};

/**
 * Renders a faction entity for use in the chat.
 *
 * @function window.chat.renderFactionEnt
 * @param {Object} faction - The faction data.
 * @returns {string} HTML string representing the faction.
 */
window.chat.renderFactionEnt = function (faction) {
  var teamId = window.teamStringToId(faction.team);
  var name = window.TEAM_NAMES[teamId];
  var spanClass = window.TEAM_TO_CSS[teamId];
  return $('&lt;div>').html($('&lt;span>')
    .attr('class', spanClass)
    .text(name)).html();
};

/**
 * Renders a player's nickname in chat.
 *
 * @function window.chat.renderPlayer
 * @param {Object} player - The player object containing nickname and team.
 * @param {boolean} at - Whether to prepend '@' to the nickname.
 * @param {boolean} sender - Whether the player is the sender of a message.
 * @returns {string} The HTML string representing the player's nickname in chat.
 */
window.chat.renderPlayer = function (player, at, sender) {
  var name = player.plain;
  if (sender) {
    name = player.plain.replace(/: $/, '');
  } else if (at) {
    name = player.plain.replace(/^@/, '');
  }
  var thisToPlayer = name === window.PLAYER.nickname;
  var spanClass = thisToPlayer ? 'pl_nudge_me' : (player.team + ' pl_nudge_player');
  return $('&lt;div>').html($('&lt;span>')
    .attr('class', spanClass)
    .attr('onclick',"window.chat.nicknameClicked(event, '"+name+"')")
    .text((at ? '@' : '') + name)).html();
};

/**
 * Renders a chat message entity based on its type.
 *
 * @function window.chat.renderMarkupEntity
 * @param {Array} ent - The entity array, where the first element is the type and the second element is the data.
 * @returns {string} The HTML string representing the chat message entity.
 */
window.chat.renderMarkupEntity = function (ent) {
  switch (ent[0]) {
  case 'TEXT':
    return chat.renderText(ent[1]);
  case 'PORTAL':
    return chat.renderPortal(ent[1]);
  case 'FACTION':
    return chat.renderFactionEnt(ent[1]);
  case 'SENDER':
    return chat.renderPlayer(ent[1], false, true);
  case 'PLAYER':
    return chat.renderPlayer(ent[1]);
  case 'AT_PLAYER':
    return chat.renderPlayer(ent[1], true);
  default:
  }
  return $('&lt;div>').text(ent[0]+':&lt;'+ent[1].plain+'>').html();
};

/**
 * Renders the markup of a chat message, converting special entities like player names, portals, etc., into HTML.
 *
 * @function window.chat.renderMarkup
 * @param {Array} markup - The markup array of a chat message.
 * @returns {string} The HTML string representing the complete rendered chat message.
 */
window.chat.renderMarkup = function (markup) {
  var msg = '';

  markup.forEach(function (ent, ind) {
    switch (ent[0]) {
      case 'SENDER':
      case 'SECURE':
        // skip as already handled
        break;

      case 'PLAYER': // automatically generated messages
        if (ind > 0) msg += chat.renderMarkupEntity(ent); // don’t repeat nick directly
        break;

      default:
        // add other enitities whatever the type
        msg += chat.renderMarkupEntity(ent);
        break;
    }
  });
  return msg;
};

/**
 * Transforms a given markup array into an older, more straightforward format for easier understanding.
 *
 * @function window.chat.transformMessage
 * @param {Array} markup - An array representing the markup to be transformed.
 * @returns {Array} The transformed markup array with a simplified structure.
 */
function transformMessage(markup) {
  // Make a copy of the markup array to avoid modifying the original input
  let newMarkup = JSON.parse(JSON.stringify(markup));

  // Collapse &lt;faction> + "Link"/"Field". Example: "Agent &lt;player> destroyed the &lt;faction> Link ..."
  if (newMarkup.length > 4) {
    if (newMarkup[3][0] === 'FACTION' &amp;&amp; newMarkup[4][0] === 'TEXT' &amp;&amp; (newMarkup[4][1].plain === ' Link ' || newMarkup[4][1].plain === ' Control Field @')) {
      newMarkup[4][1].team = newMarkup[3][1].team;
      newMarkup.splice(3, 1);
    }
  }

  // Skip "Agent &lt;player>" at the beginning
  if (newMarkup.length > 1) {
    if (newMarkup[0][0] === 'TEXT' &amp;&amp; newMarkup[0][1].plain === 'Agent ' &amp;&amp; newMarkup[1][0] === 'PLAYER') {
      newMarkup.splice(0, 2);
    }
  }

  // Skip "&lt;faction> agent &lt;player>" at the beginning
  if (newMarkup.length > 2) {
    if (newMarkup[0][0] === 'FACTION' &amp;&amp; newMarkup[1][0] === 'TEXT' &amp;&amp; newMarkup[1][1].plain === ' agent ' &amp;&amp; newMarkup[2][0] === 'PLAYER') {
      newMarkup.splice(0, 3);
    }
  }

  return newMarkup;
}

/**
 * Renders a cell in the chat table to display the time a message was sent.
 * Formats the time and adds it to a &lt;time> HTML element with a tooltip showing the full date and time.
 *
 * @function window.chat.renderTimeCell
 * @param {number} time - The timestamp of the message.
 * @param {string} classNames - Additional class names to be added to the time cell.
 * @returns {string} The HTML string representing a table cell with the formatted time.
 */
window.chat.renderTimeCell = function (time, classNames) {
  const ta = window.unixTimeToHHmm(time);
  let tb = window.unixTimeToDateTimeString(time, true);
  // add &lt;small> tags around the milliseconds
  tb = (tb.slice(0, 19) + '&lt;small class="milliseconds">' + tb.slice(19) + '&lt;/small>').replace(/&lt;/g, '&amp;lt;').replace(/>/g, '&amp;gt;').replace(/"/g, '&amp;quot;');
  return '&lt;td>&lt;time class="' + classNames + '" title="' + tb + '" data-timestamp="' + time + '">' + ta + '&lt;/time>&lt;/td>';
};

/**
 * Renders a cell in the chat table for a player's nickname.
 * Wraps the nickname in &lt;mark> HTML element for highlighting.
 *
 * @function window.chat.renderNickCell
 * @param {string} nick - The nickname of the player.
 * @param {string} classNames - Additional class names to be added to the nickname cell.
 * @returns {string} The HTML string representing a table cell with the player's nickname.
 */
window.chat.renderNickCell = function (nick, classNames) {
  const i = ['&lt;span class="invisep">&amp;lt;&lt;/span>', '&lt;span class="invisep">&amp;gt;&lt;/span>'];
  return '&lt;td>' + i[0] + '&lt;mark class="' + classNames + '">' + nick + '&lt;/mark>' + i[1] + '&lt;/td>';
};

/**
 * Renders a cell in the chat table for a chat message.
 * The message is inserted as inner HTML of the table cell.
 *
 * @function window.chat.renderMsgCell
 * @param {string} msg - The chat message to be displayed.
 * @param {string} classNames - Additional class names to be added to the message cell.
 * @returns {string} The HTML string representing a table cell with the chat message.
 */
window.chat.renderMsgCell = function (msg, classNames) {
  return '&lt;td class="' + classNames + '">' + msg + '&lt;/td>';
};

/**
 * Renders a row for a chat message including time, nickname, and message cells.
 *
 * @function window.chat.renderMsgRow
 * @param {Object} data - The data for the message, including time, player, and message content.
 * @returns {string} The HTML string representing a row in the chat table.
 */
window.chat.renderMsgRow = function (data) {
  var timeClass = data.msgToPlayer ? 'pl_nudge_date' : '';
  var timeCell = chat.renderTimeCell(data.time, timeClass);

  var nickClasses = ['nickname'];
  if (window.TEAM_TO_CSS[data.player.team]) {
    nickClasses.push(window.TEAM_TO_CSS[data.player.team]);
  }
  // highlight things said/done by the player in a unique colour
  // (similar to @player mentions from others in the chat text itself)
  if (data.player.name === window.PLAYER.nickname) {
    nickClasses.push('pl_nudge_me');
  }
  var nickCell = chat.renderNickCell(data.player.name, nickClasses.join(' '));

  const markup = transformMessage(data.markup);
  var msg = chat.renderMarkup(markup);
  var msgClass = data.narrowcast ? 'system_narrowcast' : '';
  var msgCell = chat.renderMsgCell(msg, msgClass);

  var className = '';
  if (!data.auto &amp;&amp; data.public) {
    className = 'public';
  } else if (!data.auto &amp;&amp; data.secure) {
    className = 'faction';
  }
  return '&lt;tr data-guid="' + data.guid + '" class="' + className + '">' + timeCell + nickCell + msgCell + '&lt;/tr>';
};

/**
 * Legacy function for rendering chat messages. Used for backward compatibility with plugins.
 *
 * @function window.chat.renderMsg
 * @param {string} msg - The chat message.
 * @param {string} nick - The nickname of the player who sent the message.
 * @param {number} time - The timestamp of the message.
 * @param {string} team - The team of the player who sent the message.
 * @param {boolean} msgToPlayer - Flag indicating if the message is directed to the player.
 * @param {boolean} systemNarrowcast - Flag indicating if the message is a system narrowcast.
 * @returns {string} The HTML string representing a chat message row.
 */
window.chat.renderMsg = function(msg, nick, time, team, msgToPlayer, systemNarrowcast) {
  var ta = unixTimeToHHmm(time);
  var tb = unixTimeToDateTimeString(time, true);
  // add &lt;small> tags around the milliseconds
  tb = (tb.slice(0,19)+'&lt;small class="milliseconds">'+tb.slice(19)+'&lt;/small>')
    .replace(/&lt;/g,'&amp;lt;')
    .replace(/>/g,'&amp;gt;')
    .replace(/"/g,'&amp;quot;');

  // help cursor via “#chat time”
  var t = '&lt;time title="'+tb+'" data-timestamp="'+time+'">'+ta+'&lt;/time>';
  if (msgToPlayer) {
    t = '&lt;div class="pl_nudge_date">' + t + '&lt;/div>&lt;div class="pl_nudge_pointy_spacer">&lt;/div>';
  }
  if (systemNarrowcast) {
    msg = '&lt;div class="system_narrowcast">' + msg + '&lt;/div>';
  }
  var color = COLORS[team];
  // highlight things said/done by the player in a unique colour (similar to @player mentions from others in the chat text itself)
  if (nick === window.PLAYER.nickname) {
    color = '#fd6';
  }
  var s = 'style="cursor:pointer; color:'+color+'"';
  var i = ['&lt;span class="invisep">&amp;lt;&lt;/span>', '&lt;span class="invisep">&amp;gt;&lt;/span>'];
  return '&lt;tr>&lt;td>'+t+'&lt;/td>&lt;td>'+i[0]+'&lt;mark class="nickname" ' + s + '>'+ nick+'&lt;/mark>'+i[1]+'&lt;/td>&lt;td>'+msg+'&lt;/td>&lt;/tr>';
}

/**
 * Renders a divider row in the chat table.
 *
 * @function window.chat.renderDivider
 * @param {string} text - Text to display within the divider row.
 * @returns {string} The HTML string representing a divider row in the chat table.
 */
window.chat.renderDivider = function(text) {
  return '&lt;tr class="divider">&lt;td>&lt;hr>&lt;/td>&lt;td>' + text + '&lt;/td>&lt;td>&lt;hr>&lt;/td>&lt;/tr>';
};

/**
 * Renders data from the data-hash to the element defined by the given ID.
 *
 * @function window.chat.renderData
 * @param {Object} data - Chat data to be rendered.
 * @param {string} element - ID of the DOM element to render the chat into.
 * @param {boolean} likelyWereOldMsgs - Flag indicating if older messages are likely to have been added.
 * @param {Array} sortedGuids - Sorted array of GUIDs representing the order of messages.
 */
window.chat.renderData = function(data, element, likelyWereOldMsgs, sortedGuids) {
  var elm = $('#'+element);
  if (elm.is(':hidden')) {
    return;
  }

  // if sortedGuids is not specified (legacy), sort old to new
  // (disregarding server order)
  var vals = sortedGuids;
  if (vals === undefined) {
    vals = $.map(data, function(v, k) { return [[v[0], k]]; });
    vals = vals.sort(function(a, b) { return a[0]-b[0]; });
    vals = vals.map(function(v) { return v[1]; });
  }

  // render to string with date separators inserted
  var msgs = '';
  var prevTime = null;
  vals.forEach(function(guid) {
    var msg = data[guid];
    var nextTime = new Date(msg[0]).toLocaleDateString();
    if (prevTime &amp;&amp; prevTime !== nextTime) {
      msgs += chat.renderDivider(nextTime);
    }
    msgs += msg[2];
    prevTime = nextTime;
  });

  var firstRender = elm.is(':empty');
  var scrollBefore = scrollBottom(elm);
  elm.html('&lt;table>' + msgs + '&lt;/table>');

  if (firstRender) {
    elm.data('needsScrollTop', 99999999);
  } else {
    chat.keepScrollPosition(elm, scrollBefore, likelyWereOldMsgs);
  }

  if(elm.data('needsScrollTop')) {
    elm.data('ignoreNextScroll', true);
    elm.scrollTop(elm.data('needsScrollTop'));
    elm.data('needsScrollTop', null);
  }
};

/**
 * Gets the name of the active chat tab.
 *
 * @function window.chat.getActive
 * @returns {string} The name of the active chat tab.
 */
window.chat.getActive = function() {
  return $('#chatcontrols .active').text();
}

/**
 * Converts a chat tab name to its corresponding COMM channel name.
 *
 * @function window.chat.tabToChannel
 * @param {string} tab - The name of the chat tab.
 * @returns {string} The corresponding channel name ('faction', 'alerts', or 'all').
 */
window.chat.tabToChannel = function(tab) {
  if (tab == 'faction') return 'faction';
  if (tab == 'alerts') return 'alerts';
  return 'all';
};

/**
 * Toggles the chat window between expanded and collapsed states.
 * When expanded, the chat window covers a larger area of the screen.
 * This function also ensures that the chat is scrolled to the bottom when collapsed.
 *
 * @function window.chat.toggle
 */
window.chat.toggle = function() {
  var c = $('#chat, #chatcontrols');
  if(c.hasClass('expand')) {
    c.removeClass('expand');
    var div = $('#chat > div:visible');
    div.data('ignoreNextScroll', true);
    div.scrollTop(99999999); // scroll to bottom
    $('.leaflet-control').removeClass('chat-expand');
  } else {
    c.addClass('expand');
    $('.leaflet-control').addClass('chat-expand');
    chat.needMoreMessages();
  }
};

/**
 * Allows plugins to request and monitor COMM data streams in the background. This is useful for plugins
 * that need to process COMM data even when the user is not actively viewing the COMM channels.
 * It tracks the requested channels for each plugin instance and updates the global state accordingly.
 *
 * @function window.chat.backgroundChannelData
 * @param {string} instance - A unique identifier for the plugin or instance requesting background COMM data.
 * @param {string} channel - The name of the COMM channel ('all', 'faction', or 'alerts').
 * @param {boolean} flag - Set to true to request data for the specified channel, false to stop requesting.
 */
window.chat.backgroundChannelData = function(instance,channel,flag) {
  //first, store the state for this instance
  if (!window.chat.backgroundInstanceChannel) window.chat.backgroundInstanceChannel = {};
  if (!window.chat.backgroundInstanceChannel[instance]) window.chat.backgroundInstanceChannel[instance] = {};
  window.chat.backgroundInstanceChannel[instance][channel] = flag;

  //now, to simplify the request code, merge the flags for all instances into one
  // 1. clear existing overall flags
  window.chat.backgroundChannels = {};
  // 2. for each instance monitoring COMM...
  $.each(window.chat.backgroundInstanceChannel, function(instance,channels) {
    // 3. and for each channel monitored by this instance...
    $.each(window.chat.backgroundInstanceChannel[instance],function(channel,flag) {
      // 4. if it's monitored, set the channel flag
      if (flag) window.chat.backgroundChannels[channel] = true;
    });
  });

}

/**
 * Requests chat messages for the currently active chat tab and background channels.
 * It calls the appropriate request function based on the active tab or background channels.
 *
 * @function window.chat.request
 */
window.chat.request = function() {
  var channel = chat.tabToChannel(chat.getActive());
  if (channel == 'faction' || (window.chat.backgroundChannels &amp;&amp; window.chat.backgroundChannels['faction'])) {
    chat.requestFaction(false);
  }
  if (channel == 'all' || (window.chat.backgroundChannels &amp;&amp; window.chat.backgroundChannels['all'])) {
    chat.requestPublic(false);
  }
  if (channel == 'alerts' || (window.chat.backgroundChannels &amp;&amp; window.chat.backgroundChannels['alerts'])) {
    chat.requestAlerts(false);
  }
}

/**
 * Checks if the currently selected chat tab needs more messages.
 * This function is triggered by scroll events and loads older messages when the user scrolls to the top.
 *
 * @function window.chat.needMoreMessages
 */
window.chat.needMoreMessages = function() {
  var activeTab = chat.getActive();
  if (activeTab !== 'all' &amp;&amp; activeTab !== 'faction' &amp;&amp; activeTab !== 'alerts') {
    return;
  }

  var activeChat = $('#chat > :visible');
  if(activeChat.length === 0) return;

  var hasScrollbar = scrollBottom(activeChat) !== 0 || activeChat.scrollTop() !== 0;
  var nearTop = activeChat.scrollTop() &lt;= CHAT_REQUEST_SCROLL_TOP;
  if(hasScrollbar &amp;&amp; !nearTop) return;

  if(activeTab === 'faction') {
    chat.requestFaction(true);
  } else {
    chat.requestPublic(true);
  }
};

/**
 * Chooses and activates a specified chat tab.
 * Also triggers an early refresh of the chat data when switching tabs.
 *
 * @function window.chat.chooseTab
 * @param {string} tab - The name of the chat tab to activate ('all', 'faction', or 'alerts').
 */
window.chat.chooseTab = function(tab) {
  if (tab != 'all' &amp;&amp; tab != 'faction' &amp;&amp; tab != 'alerts') {
    log.warn('chat tab "'+tab+'" requested - but only "all", "faction" and "alerts" are valid - assuming "all" wanted');
    tab = 'all';
  }

  var oldTab = chat.getActive();

  localStorage['iitc-chat-tab'] = tab;

  var mark = $('#chatinput mark');
  var input = $('#chatinput input');

  $('#chatcontrols .active').removeClass('active');
  $("#chatcontrols a:contains('" + tab + "')").addClass('active');

  if (tab != oldTab) startRefreshTimeout(0.1*1000); //only chat uses the refresh timer stuff, so a perfect way of forcing an early refresh after a tab change

  $('#chat > div').hide();

  var elm = $('#chat' + tab);
  elm.show();

  switch(tab) {
    case 'faction':
      input.css('color', '');
      mark.css('color', '');
      mark.text('tell faction:');

      chat.renderFaction(false);
      break;

    case 'all':
      input.css('cssText', 'color: #f66 !important');
      mark.css('cssText', 'color: #f66 !important');
      mark.text('broadcast:');

      chat.renderPublic(false);
      break;

    case 'alerts':
      mark.css('cssText', 'color: #bbb !important');
      input.css('cssText', 'color: #bbb !important');
      mark.text('tell Jarvis:');

      chat.renderAlerts(false);
      break;
  }
}

/**
 * Displays the chat interface and activates a specified chat tab.
 *
 * @function window.chat.show
 * @param {string} name - The name of the chat tab to show and activate.
 */
window.chat.show = function(name) {
    window.isSmartphone()
        ? $('#updatestatus').hide()
        : $('#updatestatus').show();
    $('#chat, #chatinput').show();

    window.chat.chooseTab(name);
}

/**
 * Chat tab chooser handler.
 * This function is triggered by a click event on the chat tab. It reads the tab name from the event target
 * and activates the corresponding chat tab.
 *
 * @function window.chat.chooser
 * @param {Event} event - The event triggered by clicking a chat tab.
 */
window.chat.chooser = function(event) {
  var t = $(event.target);
  var tab = t.text();
  window.chat.chooseTab(tab);
}

/**
 * Maintains the scroll position of a chat box when new messages are added.
 * This function is designed to keep the scroll position fixed when old messages are loaded, and to automatically scroll
 * to the bottom when new messages are added if the user is already at the bottom of the chat.
 *
 * @function window.chat.keepScrollPosition
 * @param {jQuery} box - The jQuery object of the chat box.
 * @param {number} scrollBefore - The scroll position before new messages were added.
 * @param {boolean} isOldMsgs - Indicates if the added messages are older messages.
 */
window.chat.keepScrollPosition = function(box, scrollBefore, isOldMsgs) {
  // If scrolled down completely, keep it that way so new messages can
  // be seen easily. If scrolled up, only need to fix scroll position
  // when old messages are added. New messages added at the bottom don’t
  // change the view and enabling this would make the chat scroll down
  // for every added message, even if the user wants to read old stuff.

  if(box.is(':hidden') &amp;&amp; !isOldMsgs) {
    box.data('needsScrollTop', 99999999);
    return;
  }

  if(scrollBefore === 0 || isOldMsgs) {
    box.data('ignoreNextScroll', true);
    box.scrollTop(box.scrollTop() + (scrollBottom(box)-scrollBefore));
  }
}




//
// setup
//

/**
 * Sets up the chat interface.
 *
 * @function window.chat.setup
 */
window.chat.setup = function() {
  if (localStorage['iitc-chat-tab']) {
    chat.chooseTab(localStorage['iitc-chat-tab']);
 }

  $('#chatcontrols, #chat, #chatinput').show();

  $('#chatcontrols a:first').click(window.chat.toggle);
  $('#chatcontrols a').each(function(ind, elm) {
    if($.inArray($(elm).text(), ['all', 'faction', 'alerts']) !== -1)
      $(elm).click(window.chat.chooser);
  });


  $('#chatinput').click(function() {
    $('#chatinput input').focus();
  });

  window.chat.setupTime();
  window.chat.setupPosting();

  $('#chatfaction').scroll(function() {
    var t = $(this);
    if(t.data('ignoreNextScroll')) return t.data('ignoreNextScroll', false);
    if(t.scrollTop() &lt; CHAT_REQUEST_SCROLL_TOP) chat.requestFaction(true);
    if(scrollBottom(t) === 0) chat.requestFaction(false);
  });

  $('#chatall').scroll(function() {
    var t = $(this);
    if(t.data('ignoreNextScroll')) return t.data('ignoreNextScroll', false);
    if(t.scrollTop() &lt; CHAT_REQUEST_SCROLL_TOP) chat.requestPublic(true);
    if(scrollBottom(t) === 0) chat.requestPublic(false);
  });

  $('#chatalerts').scroll(function() {
    var t = $(this);
    if(t.data('ignoreNextScroll')) return t.data('ignoreNextScroll', false);
    if(t.scrollTop() &lt; CHAT_REQUEST_SCROLL_TOP) chat.requestAlerts(true);
    if(scrollBottom(t) === 0) chat.requestAlerts(false);
  });

  window.requests.addRefreshFunction(chat.request);

  var cls = PLAYER.team === 'RESISTANCE' ? 'res' : 'enl';
  $('#chatinput mark').addClass(cls);

  $(document).on('click', '.nickname', function(event) {
    return window.chat.nicknameClicked(event, $(this).text());
  });
}

/**
 * Sets up the time display in the chat input box.
 * This function updates the time displayed next to the chat input field every minute to reflect the current time.
 *
 * @function window.chat.setupTime
 */
window.chat.setupTime = function() {
  var inputTime = $('#chatinput time');
  var updateTime = function() {
    if(window.isIdle()) return;
    var d = new Date();
    var h = d.getHours() + ''; if(h.length === 1) h = '0' + h;
    var m = d.getMinutes() + ''; if(m.length === 1) m = '0' + m;
    inputTime.text(h+':'+m);
    // update ON the minute (1ms after)
    setTimeout(updateTime, (60 - d.getSeconds()) * 1000 + 1);
  };
  updateTime();
  window.addResumeFunction(updateTime);
}


//
// posting
//

/**
 * Sets up the chat message posting functionality.
 *
 * @function window.chat.setupPosting
 */
window.chat.setupPosting = function() {
  if (!isSmartphone()) {
    $('#chatinput input').keydown(function(event) {
      try {
        var kc = (event.keyCode ? event.keyCode : event.which);
        if(kc === 13) { // enter
          chat.postMsg();
          event.preventDefault();
        } else if (kc === 9) { // tab
          event.preventDefault();
          window.chat.handleTabCompletion();
        }
      } catch (e) {
        log.error(e);
      }
    });
  }

  $('#chatinput').submit(function(event) {
    event.preventDefault();
    chat.postMsg();
  });
}

/**
 * Posts a chat message to the currently active chat tab.
 *
 * @function window.chat.postMsg
 */
window.chat.postMsg = function() {
  var c = chat.getActive();
  if(c == 'alerts')
    return alert("Jarvis: A strange game. The only winning move is not to play. How about a nice game of chess?\n(You can't chat to the 'alerts' channel!)");

  // unknown tab, ignore
  if (c !== 'all' &amp;&amp; c !== 'faction') {
    return;
  }

  var msg = $.trim($('#chatinput input').val());
  if(!msg || msg === '') return;

  var latlng = map.getCenter();

  var data = {message: msg,
              latE6: Math.round(latlng.lat*1E6),
              lngE6: Math.round(latlng.lng*1E6),
              tab: c};

  var errMsg = 'Your message could not be delivered. You can copy&amp;' +
               'paste it here and try again if you want:\n\n' + msg;

  window.postAjax('sendPlext', data,
    function(response) {
      if(response.error) alert(errMsg);
      startRefreshTimeout(0.1*1000); //only chat uses the refresh timer stuff, so a perfect way of forcing an early refresh after a send message
    },
    function() {
      alert(errMsg);
    }
  );

  $('#chatinput input').val('');
}
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="; height: 0">
    <div class="footer-text">Ingress Intel Total Conversion (Community Edition)</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
